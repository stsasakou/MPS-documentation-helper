<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><link rel="canonical" href="https://www.jetbrains.com/help/mps/mps-java-compatibility.html" data-react-helmet="true"/><meta charset="UTF-8"></meta><meta name="built-on" content="2024-08-08T15:14:23.59001424"><meta name="build-number" content="170"><title>MPS Java compatibility | MPS Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"configuration","level":0,"title":"Configuration","anchor":"#configuration"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/storage/help-app/v6/app.css" rel="stylesheet"><link rel="manifest" href="https://www.jetbrains.com/site.webmanifest"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="MPS Java compatibility | MPS"><meta property="og:description" content=""><meta property="og:image" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><meta property="og:site_name" content="MPS Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://www.jetbrains.com/help/mps/mps-java-compatibility.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@jetbrains_MPS"><meta name="twitter:title" content="MPS Java compatibility | MPS"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@jetbrains_MPS"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "https://www.jetbrains.com/help/mps/mps-java-compatibility.html#webpage",
    "url": "https://www.jetbrains.com/help/mps/mps-java-compatibility.html",
    "name": "MPS Java compatibility | MPS",
    "description": "",
    "image": "https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "https://www.jetbrains.com/help/mps/#website",
    "url": "https://www.jetbrains.com/help/mps/",
    "name": "MPS Help"
}</script><!-- End Schema.org --><script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
        var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&amp;l=' + l : '';
        j.async = true;
        j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-5P98');
</script>
<script src="https://resources.jetbrains.com/storage/help-app/v6/analytics.js"></script>
</head><body data-id="mps-java-compatibility" data-main-title="MPS Java compatibility" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="mps-user-s-guide.topic|MPS User's Guide///base-language.topic|Base Language"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>MPS 2024.1 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="mps-java-compatibility" id="mps-java-compatibility.topic">MPS Java compatibility</h1><section class="chapter"><h2 id="configuration" data-toc="configuration">Configuration</h2><p id="ummcf1_1">The&nbsp;<b id="ummcf1_2">Java Compiler</b> configuration tab in the preferences window&nbsp;only holds a single setting - <em id="ummcf1_3">Project bytecode version</em>.</p><figure id="ummcf1_4"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/JDK_Default_MPS.png" class="lightbox"><img alt="JDK_Default_MPS.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/JDK_Default_MPS.png" title="JDK_Default_MPS.png" width="700" height="459"></a></figure><p id="ummcf1_5">This setting defines the bytecode version of all Java classes compiled by MPS. These classes include classes generated from languages aspects, classes of the runtime solutions, classes of the sandbox solutions, and so on.</p><p id="ummcf1_6">By default, the bytecode version is set to JDK Default. This means that the version of the compiled classes will be equal to the version of Java, which MPS is running under. For example, if you run MPS under JDK 17 and JDK Default is selected, the bytecode version will be 17.</p><aside class="prompt" data-type="tip" data-title="" id="ummcf1_7"><p id="ummcf1_8">Note that MPS can only run on JDK 17 and later, so when compiling languages or MPS plugins you have to set the <b id="ummcf1_9">bytecode version</b> to 17, otherwise your languages/plugins won't be loaded. Setting the <b id="ummcf1_10">byte code</b> <b id="ummcf1_11">version</b> to earlier JDK versions is only useful for solution-only projects, which are generated into Java sources that you then compile and use outside of MPS.</p></aside><p id="ummcf1_12">Each module can specify the Java level in its module properties on the Java tab. This way only the features of the chosen language level will be enabled in <em id="ummcf1_13">BaseLanguage</em> code of that module.</p><figure id="ummcf1_14"><img alt="Java_compatibility.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Java_compatibility.png" title="Java_compatibility.png" width="650" height="228"></figure><section class="chapter"><h3 id="buildscripts" data-toc="buildscripts">Build scripts</h3><p id="ummcf1_15">Also, dont forget to set java compliance level in the&nbsp;<b id="ummcf1_16">build scripts</b>&nbsp;of your project. It should be the same as the project bytecode version.</p><figure id="ummcf1_17"><img alt="Screen-Shot-2015-01-29-at-18-08-28.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Screen-Shot-2015-01-29-at-18-08-28.png" title="Screen-Shot-2015-01-29-at-18-08-28.png" width="600" height="217"></figure></section><section class="chapter"><h3 id="usingjavaclassescompiledwithjdk1.8" data-toc="usingjavaclassescompiledwithjdk1.8">Using java classes compiled with JDK 1.8</h3><p id="ummcf1_18">In the MPS modules pool you can find the JDK solution, which holds the classes of the running Java. So when you start MPS under JDK 1.8, the latest Java Platform classes will be available in the JDK solution.</p><p id="ummcf1_19">You can also use any&nbsp;<b id="ummcf1_20">external Java classes</b>, compiled under JDK 1.8 by adding them as Java&nbsp;<b id="ummcf1_21">stubs</b>.</p><section class="chapter"><h4 id="defaultinterfacemethods" data-toc="defaultinterfacemethods">Default interface methods</h4><p id="ummcf1_22">Java 8 introduced also default methods. These are methods implemented directly in the interface. You can read about default methods here:&nbsp;<a href="http://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html" id="ummcf1_23" data-external="true" rel="noopener noreferrer">http://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html</a></p><p id="ummcf1_24">These methods can be called just like the usual instance methods.&nbsp;Sometimes, however, you need to call the default method directly from an interface that your class is implementing. For example, in case of multiple inheritance when a class implements several interfaces, each containing a default method with the same signature.</p><div class="code-block" data-lang="none">public interface A {
&nbsp;&nbsp;public default void foo()&nbsp;{
 &nbsp;&nbsp;&nbsp;&nbsp;System.out.println("A"); &nbsp;&nbsp;
  }
}

public interface B {
&nbsp;&nbsp;public default void foo()&nbsp;{
 &nbsp;&nbsp;&nbsp;&nbsp;System.out.println("B"); &nbsp;&nbsp;
  }
}
</div><p id="ummcf1_26">In that case foo() can be called explicitly on one of the interfaces via a&nbsp;<em id="ummcf1_27">SuperInterfaceMethodCall</em>&nbsp;construction, which is newly located in the&nbsp;<em id="ummcf1_28">jetbrains.mps.baseLanguage.jdk8</em>&nbsp;language.</p><figure id="ummcf1_29"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Screen-Shot-2015-01-29-at-20-39-29.png" class="lightbox"><img alt="Screen-Shot-2015-01-29-at-20-39-29.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Screen-Shot-2015-01-29-at-20-39-29.png" title="Screen-Shot-2015-01-29-at-20-39-29.png" width="600" height="137"></a></figure><p id="ummcf1_30">The&nbsp;<em id="ummcf1_31">jetbrains.mps.baseLanguage.jdk8</em>&nbsp;language allows users to create the 'default' methods in BaseLanguage interfaces.</p><figure id="ummcf1_32"><img alt="comx1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/comx1.png" title="comx1.png" width="1004" height="177"></figure><p id="ummcf1_33">The 'default' keyword is implemented by the <em id="ummcf1_34">DefaultModifier</em> concept which extends the <em id="ummcf1_35">Modifier</em> concept in the BaseLanguage.</p><p id="ummcf1_36">The transformation/substitute menu + some cosy intentions are also supplied.</p><figure id="ummcf1_37"><img alt="comx2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/comx2.png" title="comx2.png" width="1006" height="111"></figure><figure id="ummcf1_38"><img alt="comx3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/comx3.png" title="comx3.png" width="1003" height="230"></figure></section></section><section class="chapter"><h3 id="usingjavaplatformapi" data-toc="usingjavaplatformapi">Using Java platform API</h3><p id="ummcf1_39">Java 8 introduced lambda expressions, of which you can learn more here:&nbsp;<a href="http://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html" id="ummcf1_40" data-external="true" rel="noopener noreferrer">http://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html</a>.</p><p id="ummcf1_41">Here is the example of an interaction with the new JDK 8 Collections API:</p><figure id="ummcf1_42"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Screen-Shot-2015-01-29-at-18-03-43.png" class="lightbox"><img alt="Screen-Shot-2015-01-29-at-18-03-43.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Screen-Shot-2015-01-29-at-18-03-43.png" title="Screen-Shot-2015-01-29-at-18-03-43.png" width="600" height="131"></a></figure><p id="ummcf1_43">The&nbsp;<em id="ummcf1_44">forEach()</em>&nbsp;method is the new default method of&nbsp;<em id="ummcf1_45">java.lang.Iterable</em>. It takes a&nbsp;<em id="ummcf1_46">Consumer</em>&nbsp;interface as a parameter.&nbsp;<em id="ummcf1_47">Consumer</em>&nbsp;is a functional interface as it only has one method. In Java 8 it would be possible to pass a lambda expression to&nbsp;<em id="ummcf1_48">forEach()</em>. In MPS you can pass the MPS closure. A closure knows the type of the parameter taken by&nbsp;<em id="ummcf1_49">forEach()</em>&nbsp;while generating and it will be generated exactly to the correct instance of the&nbsp;<em id="ummcf1_50">Consumer</em>.</p><p id="ummcf1_51">The MPS closures are by default generated into Java classes, however, if a closure meets four compatibility rules, MPS will generate it into a Java lambda expression. Incompatibilities include the usage of:</p><ul class="list _bullet" id="ummcf1_52"><li class="list__item" id="ummcf1_53"><p>Yield operations</p></li><li class="list__item" id="ummcf1_54"><p>âFunctionalâ abstract classes</p></li><li class="list__item" id="ummcf1_55"><p>Annotations</p></li><li class="list__item" id="ummcf1_56"><p>Local variables conflicting with parent scope</p></li></ul><p> <img alt="lambdas0-5.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/lambdas0-5.png" class="inline-icon-" title="lambdas0-5.png" id="ummcf1_57" width="600" height="25"></p><figure id="ummcf1_58"><img alt="lambda1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/lambda1.png" title="lambda1.png" width="600" height="122"></figure><p id="ummcf1_59">Some issues may arise from this change:</p><ul class="list _bullet" id="ummcf1_60"><li class="list__item" id="ummcf1_61"><p>Ambiguous calls: while undetected in MPS, the Java compiler will report such issues with closures generated as lambdas.</p></li><li class="list__item" id="ummcf1_62"><p>Closure instances: as a lambda, a closure will create a single instance at runtime, as opposed to anonymous classes that create a new instance every time they are called (see screenshot below).</p></li></ul></section></section><div class="last-modified">Last modified: 11 February 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="base-language-extensions-style-guide.html" class="navigation-links__prev">Base Language Extensions Style Guide</a><a href="implementing-generators-for-baselanguage-s-extensions.html" class="navigation-links__next">Implementing generators for BaseLanguage's extensions</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/storage/help-app/v6/app.js"></script></body></html>
<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><link rel="canonical" href="https://www.jetbrains.com/help/mps/commenting-out-nodes.html" data-react-helmet="true"/><meta charset="UTF-8"></meta><meta name="built-on" content="2024-08-08T15:14:22.343001183"><meta name="build-number" content="170"><title>Commenting out nodes | MPS Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"genericsupportforcommentingoutnodesinmps","level":0,"title":"Generic support for commenting out nodes in MPS","anchor":"#genericsupportforcommentingoutnodesinmps"},{"id":"migratingawayfromyourcustomcommentingoutfunctionality","level":0,"title":"Migrating away from your custom commenting out functionality","anchor":"#migratingawayfromyourcustomcommentingoutfunctionality"}]</script><script type="application/json" id="topic-shortcuts">{"CommentByLineComment":{"Windows":{"keystrokes":[{"keys":["mod-Control","char-/"]}],"platform":"PC"},"Emacs":{"keystrokes":[{"keys":["mod-Alt","char-;"]}],"platform":"PC"},"GNOME":{"keystrokes":[{"keys":["mod-Control","char-/"]}],"platform":"PC"},"KDE":{"keystrokes":[{"keys":["mod-Control","char-/"]}],"platform":"PC"},"Sublime Text":{"keystrokes":[{"keys":["mod-Control","char-/"]}],"platform":"PC"},"XWin":{"keystrokes":[{"keys":["mod-Control","char-/"]}],"platform":"PC"},"macOS":{"keystrokes":[{"keys":["mod-Command","char-/"]}],"platform":"MAC"},"Sublime Text (macOS)":{"keystrokes":[{"keys":["mod-Command","char-/"]}],"platform":"MAC"}},"CtrlCommand":{"Windows":{"keystrokes":[{"keys":["mod-Control"]}],"platform":"PC"},"Emacs":{"keystrokes":[{"keys":["mod-Control"]}],"platform":"PC"},"GNOME":{"keystrokes":[{"keys":["mod-Control"]}],"platform":"PC"},"KDE":{"keystrokes":[{"keys":["mod-Control"]}],"platform":"PC"},"Sublime Text":{"keystrokes":[{"keys":["mod-Control"]}],"platform":"PC"},"XWin":{"keystrokes":[{"keys":["mod-Control"]}],"platform":"PC"},"macOS":{"keystrokes":[{"keys":["mod-Command"]}],"platform":"MAC"},"Sublime Text (macOS)":{"keystrokes":[{"keys":["mod-Command"]}],"platform":"MAC"}}}</script><link href="https://resources.jetbrains.com/storage/help-app/v6/app.css" rel="stylesheet"><link rel="manifest" href="https://www.jetbrains.com/site.webmanifest"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Commenting out nodes | MPS"><meta property="og:description" content=""><meta property="og:image" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><meta property="og:site_name" content="MPS Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://www.jetbrains.com/help/mps/commenting-out-nodes.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@jetbrains_MPS"><meta name="twitter:title" content="Commenting out nodes | MPS"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@jetbrains_MPS"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "https://www.jetbrains.com/help/mps/commenting-out-nodes.html#webpage",
    "url": "https://www.jetbrains.com/help/mps/commenting-out-nodes.html",
    "name": "Commenting out nodes | MPS",
    "description": "",
    "image": "https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "https://www.jetbrains.com/help/mps/#website",
    "url": "https://www.jetbrains.com/help/mps/",
    "name": "MPS Help"
}</script><!-- End Schema.org --><script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
        var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&amp;l=' + l : '';
        j.async = true;
        j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-5P98');
</script>
<script src="https://resources.jetbrains.com/storage/help-app/v6/analytics.js"></script>
</head><body data-id="commenting-out-nodes" data-main-title="Commenting out nodes" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="mps-user-s-guide.topic|MPS User's Guide///mps-tutorials.topic|Tutorials"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>MPS 2024.1 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="commenting-out-nodes" id="commenting-out-nodes.topic">Commenting out nodes</h1><section class="chapter"><h2 id="genericsupportforcommentingoutnodesinmps" data-toc="genericsupportforcommentingoutnodesinmps">Generic support for commenting out nodes in MPS</h2><p id="-tlsgst_1">MPS provides a universal way to comment out nodes in models. In previous versions, this functionality had to be implemented in all languages separately, either through node attributes or dedicated comment nodes. Since MPS 3.3 the information about a commented-out node is stored in the model in a generic way. The <em id="-tlsgst_2">smodel</em> language ignores commented-out nodes by default so that your queries do not have to filter out commented-out nodes explicitly.</p><p id="-tlsgst_3">Additionally, actions have been created to comment/uncomment out a node by hitting <kbd id="-tlsgst_4" data-key="CtrlCommand">Ctrl</kbd>.</p><aside class="prompt" data-type="tip" data-title="" id="-tlsgst_5"><p id="-tlsgst_6">You can watch a <a href="https://youtu.be/mZv7PQH8nsY" id="-tlsgst_7" data-external="true" rel="noopener noreferrer">short screencast on generic commenting out</a> that explains the feature and describes the customization options.</p></aside><section class="chapter"><h3 id="howtouseit" data-toc="howtouseit">How to use it</h3><aside class="prompt" data-type="warning" data-title="" id="-tlsgst_8"><p id="-tlsgst_9">In the previous versions of MPS language authors had to provide their own implementations of the comment-out functionality for their languages. Thus, it may happen that the old language-specific functionality will clash with the new generic functionality of MPS 3.3, especially the keyboard shortcut <kbd id="-tlsgst_10" data-key="CommentByLineComment">Ctrl+/</kbd> is now taken by the generic comment-out action and will not work for the specific implementations, if they were using this keyboard shortcut before. It is advisable for the language authors to:</p><ol class="list _decimal" id="-tlsgst_11" type="1"><li class="list__item" id="-tlsgst_12"><p>choose a different key combination to trigger the specific comment out/uncomment functionality</p></li><li class="list__item" id="-tlsgst_13"><p>deprecate the custom comment-out functionality</p></li><li class="list__item" id="-tlsgst_14"><p>customize the generic comment-out functionality</p></li><li class="list__item" id="-tlsgst_15"><p>provide a migration that automatically replaces usages of the custom comment-out functionality with the generic one</p></li><li class="list__item" id="-tlsgst_16"><p>eventually remove the custom comment-out functionality</p></li></ol><p id="-tlsgst_17">A semi-automated migration process is available in MPS 3.3 to help you migrate painlessly. Check out the <span id="-tlsgst_18">Migrating away from your custom commenting out functionality</span> section below.</p></aside><p id="-tlsgst_19">You can select any node in MPS, except roots, and press <kbd id="-tlsgst_20" data-key="CommentByLineComment">Ctrl+/</kbd>. That node will be commented out.&nbsp;Lets watch some examples:</p><figure id="-tlsgst_21"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/mps-comment1.png" class="lightbox"><img alt="mps-comment1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mps-comment1.png" title="mps-comment1.png" width="500" height="260"></a></figure><p id="-tlsgst_22">The node that you select or point the cursor at will get commented out.&nbsp;Every single non-root node can be commented out - irrespective of whether it occupies a whole line, several lines, or whether it is nested deeply in an expression-like hierarchy.</p><figure id="-tlsgst_23"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/mps-comment2.png" class="lightbox"><img alt="mps-comment2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mps-comment2.png" title="mps-comment2.png" width="580" height="229"></a></figure><figure id="-tlsgst_24"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Comment3.png" class="lightbox"><img alt="Comment3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Comment3.png" title="Comment3.png" width="580" height="272"></a></figure><p id="-tlsgst_25">If you comment out a node, it will be physically removed from its place in the model. If the commented-out node occupied a requested child link, an empty cell is provided so that the user can fill in a new child value.</p><figure id="-tlsgst_26"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Comment4.png" class="lightbox"><img alt="Comment4.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Comment4.png" title="Comment4.png" width="900" height="219"></a></figure><p id="-tlsgst_27">In <em id="-tlsgst_28">BaseLanguage</em>, for example, this gives you possibilities beyond what the Java parsers allows.&nbsp;You can comment out an IfStatements condition:</p><figure id="-tlsgst_29"><img alt="Comment5.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Comment5.png" title="Comment5.png" width="280" height="53"></figure><p id="-tlsgst_30">a method parameter:</p><figure id="-tlsgst_31"><img alt="Comment6.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Comment6.png" title="Comment6.png" width="405" height="63"></figure><p id="-tlsgst_32">or a variable type:</p><p> <img alt="Comment7.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Comment7.png" class="inline-icon-" title="Comment7.png" id="-tlsgst_33" width="205" height="22"></p><p id="-tlsgst_34">To give another example, the editor definition language allows you to comment out an editor cell, for example:</p><p> <img alt="Comment8.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Comment8.png" class="inline-icon-" title="Comment8.png" id="-tlsgst_35" width="429" height="23"></p><aside class="prompt" data-type="tip" data-title="" id="-tlsgst_36"><p id="-tlsgst_37">To uncomment a commented-out node you press <kbd id="-tlsgst_38" data-key="CommentByLineComment">Ctrl+/</kbd> while positioned on it.</p></aside></section><section class="chapter"><h3 id="smartcommentingout" data-toc="smartcommentingout">Smart commenting out</h3><p id="-tlsgst_39">The comment and uncomment actions have some intelligence in them in order to decide, which node to comment/uncomment.</p><ul class="list _bullet" id="-tlsgst_40"><li class="list__item" id="-tlsgst_41"><p>if a node or a set of nodes is selected, this node/nodes will be commented out/uncommented</p></li><li class="list__item" id="-tlsgst_42"><p>if no node is selected, the editor attempts to comment out/uncomment the current "line" - to achieve this a search starts in the node under caret to identify the closest ancestor vertical collection and an ancestor of the node under caret that is a member of this vertical collection will be commented out/uncommented</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="-tlsgst_43"><p id="-tlsgst_44">You may get finer-grained control over the mechanism of detecting the ancestor line of the node under caret - simply define a handler for the <em id="-tlsgst_45">COMMENT</em> action on a collection of cells as follows:</p><figure id="-tlsgst_46"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/commentLine2.png" class="lightbox"><img alt="commentLine2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/commentLine2.png" title="commentLine2.png" width="100" height="40"></a></figure><figure id="-tlsgst_47"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/commentLine3.png" class="lightbox"><img alt="commentLine3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/commentLine3.png" title="commentLine3.png" width="100" height="24"></a></figure></aside></section><section class="chapter"><h3 id="howdoesitworkinthemodel" data-toc="howdoesitworkinthemodel">How does it work in the model</h3><p id="-tlsgst_48">When a node is commented out, it is placed as a child (wrapped) in a special child attribute, called <em id="-tlsgst_49">BaseCommentAttribute</em>. Then the instance of this attribute is attached to the commented nodes link in the former parent of the commented node.&nbsp;A <em id="-tlsgst_50">ChildAttribute</em> is same as the <em id="-tlsgst_51">LinkAttribute</em>&nbsp;concept, except that <em id="-tlsgst_52">ChildAttribute</em>&nbsp;gets attached to aggregation links.&nbsp;So the commented nodes are not stored as the usual children, and they won't appear normal queries for child roles. Also, the <em id="-tlsgst_53">node.children</em> operation ignores commented-out nodes. Use <em id="-tlsgst_54">node.childrenAndChildAttributes&lt;role&gt;</em> to collect children from comments as well. The <em id="-tlsgst_55">node.descendants</em> operation currently returns the commented-out nodes, which may change in the future version of MPS to make it consistent with the <em id="-tlsgst_56">node.children</em> operation.</p><figure id="-tlsgst_57"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Comment9.png" class="lightbox"><img alt="Comment9.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Comment9.png" title="Comment9.png" width="600" height="411"></a></figure><p id="-tlsgst_58">The MPS editor knows about comments and it will draw children as well as the commented-out nodes, in this role.</p><aside class="prompt" data-type="tip" data-title="" id="-tlsgst_59"><p id="-tlsgst_60">The&nbsp;<em id="-tlsgst_61">BaseCommentAttribute</em> annotation comes from&nbsp;<em id="-tlsgst_62">jetbrains.mps.lang.core</em>, so this language needs to be listed among used languages in models that contain commented-out nodes.</p></aside></section><section class="chapter"><h3 id="queryingforcommentednodes" data-toc="queryingforcommentednodes">Querying for commented nodes</h3><p id="-tlsgst_63">The <em id="-tlsgst_64">smodel</em>&nbsp;language gives you options to query for the commented nodes. You use the same syntax that works for any attributes, only that the <em id="-tlsgst_65">comment</em>&nbsp;attribute allows for parametrization by the containment link. For example, if a <em id="-tlsgst_66">node</em>&nbsp;has a child collection named <em id="-tlsgst_67">commands</em>, querying whether any of the <em id="-tlsgst_68">commands</em>&nbsp;children has been commented out might look like:</p><div class="code-block" data-lang="none">node.@comment&lt;commands&gt;.isNotEmpty
</div></section><section class="chapter"><h3 id="customization" data-toc="customization">Customization</h3><p id="-tlsgst_70">By default every commented node is drawn surrounded by <em id="-tlsgst_71">/* */</em>. You can override the visual appearance of a commented-out node by defining a custom <b id="-tlsgst_72">commented editor</b> for the concept.&nbsp;Just define the usual editor with the hint <em id="-tlsgst_73">comment</em>:</p><figure id="-tlsgst_74"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Comment10.png" class="lightbox"><img alt="Comment10.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Comment10.png" title="Comment10.png" width="300" height="261"></a></figure><aside class="prompt" data-type="tip" data-title="" id="-tlsgst_75"><p id="-tlsgst_76">For the <b id="-tlsgst_77">comment</b> hint to be available, your editor model needs to import the <em id="-tlsgst_78">jetbrains.mps.lang.core.editor</em> model.</p></aside><p id="-tlsgst_79">The style of the editor should be changed so that the user can easily visually distinguish commented code.</p><figure id="-tlsgst_80"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Commentx1.png" class="lightbox"><img alt="Commentx1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Commentx1.png" title="Commentx1.png" width="500" height="460"></a></figure><p id="-tlsgst_81">You can either re-use the pre-defined&nbsp;<em id="-tlsgst_82">Comment</em> style, which uses a gray color with italics style, or you may create your own style for commented-out nodes.</p><p id="-tlsgst_83"><b id="-tlsgst_84">Note:</b> The children of the commented node should be drawn with their usual editor so you need to remove the comment hint in child cells:</p><figure id="-tlsgst_85"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Comment11.png" class="lightbox"><img alt="Comment11.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Comment11.png" title="Comment11.png" width="500" height="772"></a></figure></section><section class="chapter"><h3 id="easiercustomization" data-toc="easiercustomization">Easier customization</h3><p id="-tlsgst_86">The&nbsp;<b id="-tlsgst_87">next applicable editor</b> cell gives you a more convenient way to customize the look of commented-out nodes - you may address several concepts in a hierarchy with a single customized comment editor.</p><figure id="-tlsgst_88"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Commxy1.png" class="lightbox"><img alt="Commxy1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Commxy1.png" title="Commxy1.png" width="500" height="239"></a></figure><p id="-tlsgst_89">The <b id="-tlsgst_90">next applicable editor</b>&nbsp;cell simply removes the <b id="-tlsgst_91">comment</b>&nbsp;hint and redirects the request to find the original editor of the concept (<em id="-tlsgst_92">IfStatement</em>). This avoids the need for repetition of the editor definition. You may further simplify the task, if&nbsp;you define a single editor bound to the <b id="-tlsgst_93">comment</b> hint for a common super-concept - this way all subconcepts will get the customized comment editor.</p></section><section class="chapter"><h3 id="commentingout/uncommentingnodesfromcode" data-toc="commentingout/uncommentingnodesfromcode">Commenting out/uncommenting nodes from code</h3><p id="-tlsgst_94">The&nbsp;<em id="-tlsgst_95">CommentUtil</em> class from&nbsp;<em id="-tlsgst_96">jetbrains.mps.editor.runtime</em> can be used to comment out and uncomment nodes from code, such as actions, intentions or key maps. This gives you options to further customize the behavior of commented-out nodes.</p><p id="-tlsgst_97">The&nbsp;<em id="-tlsgst_98">CellAction_CommentOrUncomment</em> and its inheritors&nbsp;class come from the same package. They give you the way to simply comment the node and restore the selection or uncomment the node if it is currently commented.</p></section><section class="chapter"><h3 id="thecommenteditoraction" data-toc="thecommenteditoraction">The Comment editor action</h3><p id="-tlsgst_99">The response to the comment/uncomment action can also be customized on the node level. You can set the handler for&nbsp;<b id="-tlsgst_100">COMMENT</b>&nbsp;action in the cell's action map:</p><figure id="-tlsgst_101"><img alt="disable_commenting.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/disable_commenting.png" title="disable_commenting.png" width="700" height="232"></figure><p id="-tlsgst_102">For example, if we want to prevent the user from commenting out conditions in the robot's Kaja&nbsp;<em id="-tlsgst_103">While</em>&nbsp;statement, we attach the above action map to the While editor's cell representing the&nbsp;<em id="-tlsgst_104">condition</em> <b id="-tlsgst_105">:</b></p><figure id="-tlsgst_106"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Comment13.png" class="lightbox"><img alt="Comment13.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Comment13.png" title="Comment13.png" width="500" height="397"></a></figure><p id="-tlsgst_107">Since the&nbsp;<b id="-tlsgst_108">COMMENT</b>&nbsp;action is customized it will do what is indicated.</p><p id="-tlsgst_109">The action will work only if the&nbsp;<em id="-tlsgst_110">condition</em> node is selected.</p><p id="-tlsgst_111">Since we create the&nbsp;<em id="-tlsgst_112">CellAction_CommentOrUncommentNode</em> with the&nbsp;<em id="-tlsgst_113">node</em> as the parameter, where the&nbsp;<em id="-tlsgst_114">node</em>&nbsp;is the&nbsp;<em id="-tlsgst_115">While</em>&nbsp;statement, the action will process the&nbsp;<em id="-tlsgst_116">While</em>&nbsp;statement:</p><p id="-tlsgst_117">1) If it is not commented, the action will comment it out.</p><p id="-tlsgst_118">2) If it is commented out, the action will uncomment it.</p><p id="-tlsgst_119">Thus the commenting of the&nbsp;<em id="-tlsgst_120">condition</em> will be disabled.</p></section></section><section class="chapter"><h2 id="migratingawayfromyourcustomcommentingoutfunctionality" data-toc="migratingawayfromyourcustomcommentingoutfunctionality">Migrating away from your custom commenting out functionality</h2><p id="-tlsgst_121">In versions prior to MPS 3.3 language authors had to implement the comment out functionality themselves for each language individually. In MPS 3.3 the custom functionality may be redundant and should be replaced by the generic functionality provided by MPS, perhaps with some customization as described above.&nbsp;The existing usages of the old custom commenting-out functionality should be migrated to the generic version, which should be done in several steps:</p><ol class="list _decimal" id="-tlsgst_122" type="1"><li class="list__item" id="-tlsgst_123"><p>Your old concepts used for commenting out should be deprecated</p></li><li class="list__item" id="-tlsgst_124"><p>Your keyboard shortcuts, actions and intentions for commenting out/uncommenting should be deprecated or removed</p></li><li class="list__item" id="-tlsgst_125"><p>You may wish to customize the look of commented-out nodes by defining custom editors attached to the "comment" editor hint (as described above)</p></li><li class="list__item" id="-tlsgst_126"><p>You may also wish to disable the generic comment-out functionality on some editor cells (as described above)</p></li><li class="list__item" id="-tlsgst_127"><p>You may need to provide a migration that will automatically translate usages of your old custom commented nodes in user code into nodes commented in the generic way. This can be done either fully manually or with MPS assistance.</p></li></ol><section class="chapter"><h3 id="mps-assistedmigration" data-toc="mps-assistedmigration">MPS-assisted migration</h3><p id="-tlsgst_128">MPS can create a&nbsp;<em id="-tlsgst_129">Migration</em> for you, provided you indicate, which concepts represent the old custom comments using the&nbsp;<em id="-tlsgst_130">IOldCommentAnnotation</em> and&nbsp;<em id="-tlsgst_131">IOldCommentContainer</em>. Since there were two typical ways to create custom comments in the past, there need to be two interface:</p><ul class="list _bullet" id="-tlsgst_132"><li class="list__item" id="-tlsgst_133"><p><em id="-tlsgst_134">IOldCommentAnnotation</em> - should be implemented by the&nbsp;<em id="-tlsgst_135">NodeAttribute</em> that indicates a node is commented out, if attributes were used annotate commented-out nodes</p></li><li class="list__item" id="-tlsgst_136"><p><em id="-tlsgst_137">IOldCommentContainer</em> - in case commented nodes were represented by a dedicated concept, such as&nbsp;<em id="-tlsgst_138">SingleLineComment</em>, these dedicated concepts should be marked with this concept interface</p></li></ul><p id="-tlsgst_139">These marker concept interfaces come from&nbsp;<em id="-tlsgst_140">jetbrains.mps.lang.core</em>, so this language needs to extended by your language in order to use them. Once annotated, the generic comment-out functionality will be ceased on the nodes of these concepts in favor of the old custom comment out functionality.</p><p id="-tlsgst_141">Additionally, the old commenting-out concepts will have warnings reported on them -&nbsp;<b id="-tlsgst_142">Old comment container should be migrated</b> or&nbsp;<b id="-tlsgst_143">Old comment annotation should be migrated</b>. The quick-fixes for these warnings will create the necessary migrations to convert your old custom commenting-out scheme into the generic one painlessly. Just trigger the quick fixes, check the generated migrations and then migrate your projects.</p></section><section class="chapter"><h3 id="fullymanualmigration" data-toc="fullymanualmigration">Fully manual migration</h3><p id="-tlsgst_144">You may create the migration fully manually. Typically all that your migration needs to do is to find all nodes being commented out in the old custom way, uncomment them and call&nbsp;<em id="-tlsgst_145">CommentUtil.comment()</em>&nbsp;on each node to get it commented out in the new way. The&nbsp;<em id="-tlsgst_146">CommentUtil</em>&nbsp;class comes from&nbsp;<em id="-tlsgst_147">jetbrains.mps.editor.runtime</em>.</p><p id="-tlsgst_148">The generic comment out functionality marks commented-out nodes with the&nbsp;<em id="-tlsgst_149">BaseCommentAttribute</em> annotation that is attached to the parent of the commented-out node, holds the original role of the commented-out node and comes from&nbsp;<em id="-tlsgst_150">jetbrains.mps.lang.core</em>, so this language needs to be used in models that contain commented-out nodes. An automatic migration should add such language dependency to all altered models. You may take inspiration from The&nbsp;<em id="-tlsgst_151">ReplaceSingleLineCommentsWithGenericComments</em> migration, which migrated&nbsp;<em id="-tlsgst_152">SingleLineComment</em> nodes in <em id="-tlsgst_153">BaseLanguage</em>:</p><figure id="-tlsgst_154"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Mig1.png" class="lightbox"><img alt="Mig1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Mig1.png" title="Mig1.png" width="900" height="342"></a></figure><figure id="-tlsgst_155"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Mig2.png" class="lightbox"><img alt="Mig2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Mig2.png" title="Mig2.png" width="500" height="112"></a></figure></section></section><div class="last-modified">Last modified: 09 May 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="requirement-tracking-language.html" class="navigation-links__prev">Requirement tracking language</a><a href="common-language-patterns.html" class="navigation-links__next">Common language patterns</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/storage/help-app/v6/app.js"></script></body></html>
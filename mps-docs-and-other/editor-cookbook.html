<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><link rel="canonical" href="https://www.jetbrains.com/help/mps/editor-cookbook.html" data-react-helmet="true"/><meta charset="UTF-8"></meta><meta name="built-on" content="2024-08-08T15:14:23.364315912"><meta name="build-number" content="170"><title>Editor cookbook | MPS Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"howtocreateaneditordefinition","level":0,"title":"How to create an editor definition","anchor":"#howtocreateaneditordefinition"},{"id":"enhancingtheeditordefinition","level":0,"title":"Enhancing the editor definition","anchor":"#enhancingtheeditordefinition"},{"id":"commoneditorpatterns","level":0,"title":"Common editor patterns","anchor":"#commoneditorpatterns"},{"id":"includingparentstransformactions","level":0,"title":"Including parents transform actions","anchor":"#includingparentstransformactions"},{"id":"conceptualquestions","level":0,"title":"Conceptual questions","anchor":"#conceptualquestions"},{"id":"howtodefinemultipleeditorsforthesameconcept","level":0,"title":"How to define multiple editors for the same concept","anchor":"#howtodefinemultipleeditorsforthesameconcept"},{"id":"howtomanipulateandapplyeditorhintsprogrammatically","level":0,"title":"How to manipulate and apply editor hints programmatically","anchor":"#howtomanipulateandapplyeditorhintsprogrammatically"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/storage/help-app/v6/app.css" rel="stylesheet"><link rel="manifest" href="https://www.jetbrains.com/site.webmanifest"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Editor cookbook | MPS"><meta property="og:description" content=""><meta property="og:image" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><meta property="og:site_name" content="MPS Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://www.jetbrains.com/help/mps/editor-cookbook.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@jetbrains_MPS"><meta name="twitter:title" content="Editor cookbook | MPS"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@jetbrains_MPS"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "https://www.jetbrains.com/help/mps/editor-cookbook.html#webpage",
    "url": "https://www.jetbrains.com/help/mps/editor-cookbook.html",
    "name": "Editor cookbook | MPS",
    "description": "",
    "image": "https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "https://www.jetbrains.com/help/mps/#website",
    "url": "https://www.jetbrains.com/help/mps/",
    "name": "MPS Help"
}</script><!-- End Schema.org --><script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
        var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&amp;l=' + l : '';
        j.async = true;
        j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-5P98');
</script>
<script src="https://resources.jetbrains.com/storage/help-app/v6/analytics.js"></script>
</head><body data-id="editor-cookbook" data-main-title="Editor cookbook" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="mps-user-s-guide.topic|MPS User's Guide///mps-tutorials.topic|Tutorials"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>MPS 2024.1 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="editor-cookbook" id="editor-cookbook.topic">Editor cookbook</h1><p id="-y9k69l_1">This document, intended for advanced language designers, should give you the answers to the most common questions related to the MPS editor. You may also like to read the&nbsp;<a href="editor.html" id="-y9k69l_2">Editor documentation</a>, which contains exhaustive information on the subject.</p><aside class="prompt" data-type="tip" data-title="" id="-y9k69l_3"><p id="-y9k69l_4">The <b id="-y9k69l_5">RobotKaja</b>&nbsp;sample project, which comes bundled with MPS, can serve you as a good example of how to build a fluent text-like projectional editor.</p><p id="-y9k69l_6">You may also like to check out a couple of screen-casts that focus on defining smooth editors:</p><ul class="list _bullet" id="-y9k69l_7"><li class="list__item" id="-y9k69l_8"><p><a href="http://www.youtube.com/watch?v=CFgzzARhJWg" id="-y9k69l_9" data-external="true" rel="noopener noreferrer">Smoothing the Editor Experience</a></p></li><li class="list__item" id="-y9k69l_10"><p><a href="http://www.youtube.com/watch?v=SU70DxnNYu0" id="-y9k69l_11" data-external="true" rel="noopener noreferrer">Optional visibility in the editor</a></p></li><li class="list__item" id="-y9k69l_12"><p><a href="http://www.youtube.com/watch?v=xC7aQkFVxy0" id="-y9k69l_13" data-external="true" rel="noopener noreferrer">Using Editor Components</a></p></li></ul></aside><section class="chapter"><h2 id="howtocreateaneditordefinition" data-toc="howtocreateaneditordefinition">How to create an editor definition</h2><p id="-y9k69l_14">The DSL that MPS offers language designers to design editors is built around the notion of cells. The language designer combines editor cells and places them on the screen in a way that reflects the desired final layout of the notation.</p><figure id="-y9k69l_15"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-17-45-11.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-17-45-11.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-17-45-11.png" title="Sni-mek-obrazovky-2018-10-17-v-17-45-11.png" width="500" height="345"></a></figure><p id="-y9k69l_16">The inspector window at the bottom of the screen, which can be slides in after pressing the&nbsp;<b id="-y9k69l_17">Inspector</b> tool button in the bottom-right corner of the screen or using the&nbsp;<em id="-y9k69l_18">Alt/Cmd + 2</em> keyboard shortcut, shows additional styling and layout properties of the cell selected in the editor above.</p><p id="-y9k69l_19">An empty editor definition shows a red placeholder for a single cell</p><figure id="-y9k69l_20"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-55-02.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-14-55-02.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-55-02.png" title="Sni-mek-obrazovky-2018-10-17-v-14-55-02.png" width="300" height="114"></a></figure><p id="-y9k69l_21">Pressing&nbsp;<em id="-y9k69l_22">Control + Space</em> will offer various types of editor cells that can be inserted. The&nbsp;<b id="-y9k69l_23">constant</b> cell, for example, will display given un-modifiable text label.</p><figure id="-y9k69l_24"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-59-55.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-14-59-55.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-59-55.png" title="Sni-mek-obrazovky-2018-10-17-v-14-59-55.png" width="300" height="82"></a></figure><p id="-y9k69l_25">An empty constant text looks like this in the editor definition:</p><figure id="-y9k69l_26"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/s0.png" class="lightbox"><img alt="s0.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/s0.png" title="s0.png" width="300" height="83"></a></figure><p id="-y9k69l_27">When used by the end user, the editor will show an empty space in place of the empty constant cell.</p><p id="-y9k69l_28">You can type any arbitrary text that you want the constant cell to display to the user at run-time:</p><figure id="-y9k69l_29"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-15-00-16.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-15-00-16.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-15-00-16.png" title="Sni-mek-obrazovky-2018-10-17-v-15-00-16.png" width="300" height="84"></a></figure><section class="chapter"><h3 id="cellsmappedtoproperties,nodesorreferences" data-toc="cellsmappedtoproperties,nodesorreferences">Cells mapped to properties, nodes or references</h3><p id="-y9k69l_30">The completion menu also offers cells that will show values of a node's property, a child or the target of a reference. These cells also typically allow the users to modify the values displayed.</p><figure id="-y9k69l_31"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-55-16.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-14-55-16.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-55-16.png" title="Sni-mek-obrazovky-2018-10-17-v-14-55-16.png" width="300" height="89"></a></figure><figure id="-y9k69l_32"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-55-50.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-14-55-50.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-55-50.png" title="Sni-mek-obrazovky-2018-10-17-v-14-55-50.png" width="300" height="82"></a></figure></section><section class="chapter"><h3 id="layout" data-toc="layout">Layout</h3><p id="-y9k69l_33">Editors that consist of a single cell are not very useful. In order to combine multiple cells in the editor definition a&nbsp;<b id="-y9k69l_34">collection layout cell</b> must be used. MPS offers three types of these -&nbsp;<b id="-y9k69l_35">vertical</b>, <b id="-y9k69l_36">horizontal</b> and&nbsp;<b id="-y9k69l_37">indent</b> collection layout cells.</p><figure id="-y9k69l_38"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-56-12.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-14-56-12.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-56-12.png" title="Sni-mek-obrazovky-2018-10-17-v-14-56-12.png" width="300" height="111"></a></figure><p id="-y9k69l_39">The collection layout cell will take care of positioning the cells that it wraps:</p><figure id="-y9k69l_40"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-56-26.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-14-56-26.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-56-26.png" title="Sni-mek-obrazovky-2018-10-17-v-14-56-26.png" width="300" height="111"></a></figure><figure id="-y9k69l_41"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-56-51.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-14-56-51.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-56-51.png" title="Sni-mek-obrazovky-2018-10-17-v-14-56-51.png" width="300" height="111"></a></figure><p id="-y9k69l_42">Hit&nbsp;<em id="-y9k69l_43">Enter</em> to insert and additional cell:</p><figure id="-y9k69l_44"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-57-01.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-14-57-01.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-57-01.png" title="Sni-mek-obrazovky-2018-10-17-v-14-57-01.png" width="300" height="110"></a></figure><figure id="-y9k69l_45"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-57-15.png" class="lightbox"><img alt="Sni-mek-obrazovky-2018-10-17-v-14-57-15.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Sni-mek-obrazovky-2018-10-17-v-14-57-15.png" title="Sni-mek-obrazovky-2018-10-17-v-14-57-15.png" width="300" height="116"></a></figure><p id="-y9k69l_46">This way you can insert as many cells as needed. Nesting&nbsp;<b id="-y9k69l_47">collection layout cells</b> in other&nbsp;<b id="-y9k69l_48">collection layout cells</b> is possible.</p><p id="-y9k69l_49">The&nbsp;<b id="-y9k69l_50">indent</b> layout gives the designer control over where to wrap lines. Setting the&nbsp;<em id="-y9k69l_51">indent-layout-new-line</em> property in the inspector for a cell will make the cell the last on a line.</p><figure id="-y9k69l_52"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/s1.png" class="lightbox"><img alt="s1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/s1.png" title="s1.png" width="300" height="196"></a></figure><p id="-y9k69l_53">The following cell will be placed on the line below:</p><figure id="-y9k69l_54"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/s2.png" class="lightbox"><img alt="s2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/s2.png" title="s2.png" width="300" height="196"></a></figure><p id="-y9k69l_55">Similarly, setting the&nbsp;<em id="-y9k69l_56">indent-layout-indent</em>&nbsp;property will make a cell indented:</p><figure id="-y9k69l_57"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/s3.png" class="lightbox"><img alt="s3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/s3.png" title="s3.png" width="300" height="205"></a></figure></section><section class="chapter"><h3 id="howtoproperlyindentablockofcode" data-toc="howtoproperlyindentablockofcode">How to properly indent a block of code</h3><p id="-y9k69l_58">Nested blocks of code are typically represented using indented collections of vertically organized statements. In MPS you almost exclusively use <em id="-y9k69l_59">indented layout</em>&nbsp;for such collections, if you aim at making the experience as text-like as possible. <em id="-y9k69l_60">Vertical</em>&nbsp;and&nbsp;<em id="-y9k69l_61">horizontal</em>&nbsp;layouts should be only considered for positional or more graphical-like layouts.</p><p id="-y9k69l_62">So for properly indented code blocks you need to create an <em id="-y9k69l_63">Indented collection</em>&nbsp;(<em id="-y9k69l_64">[- ... -]</em>) and set:</p><ul class="list _bullet" id="-y9k69l_65"><li class="list__item" id="-y9k69l_66"><p><em id="-y9k69l_67">indent-layout-new-line-children</em>&nbsp;so that each collection element (child) is placed on a new line</p></li><li class="list__item" id="-y9k69l_68"><p><em id="-y9k69l_69">indent-layout-indent</em>&nbsp;to make the whole collection indented</p></li><li class="list__item" id="-y9k69l_70"><p><em id="-y9k69l_71">indent-layout-new-line</em>&nbsp;to place a <em id="-y9k69l_72">new line mark</em> behind the collection, so that next nodes get placed on a new line underneath the collection</p></li><li class="list__item" id="-y9k69l_73"><p><em id="-y9k69l_74">indent-layout-on-new-line</em>&nbsp;Optionally you may need this flag to place the whole collection on a new line instead of just appending it to the previous cell</p></li></ul><figure id="-y9k69l_75"><img alt="Editor15.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor15.png" title="Editor15.png" width="542" height="312"></figure></section></section><section class="chapter"><h2 id="enhancingtheeditordefinition" data-toc="enhancingtheeditordefinition">Enhancing the editor definition</h2><section class="chapter"><h3 id="alias" data-toc="alias">Alias</h3><p id="-y9k69l_76">Concepts can have an <em id="-y9k69l_77">alias</em>&nbsp;defined, which will represent them in code-completion pop-up menu and which will allow users to insert instances of these concept just by typing the alias. The <b id="-y9k69l_78">editor</b>&nbsp;can then refer to the text of the alias using the <em id="-y9k69l_79">AliasEditorComponent</em>&nbsp;editor component. This is in particular useful, when multiple concrete concepts inherit an editor from an abstract parent and the alias is used to visually differentiate between the multiple concepts.</p><figure id="-y9k69l_80"><img alt="Editor101.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor101.png" title="Editor101.png" width="494" height="151"></figure><figure id="-y9k69l_81"><img alt="Editor102.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor102.png" title="Editor102.png" width="494" height="152"></figure><figure id="-y9k69l_82"><img alt="Editor103.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor103.png" title="Editor103.png" width="656" height="133"></figure><p id="-y9k69l_83">You then refer to the alias value through the <em id="-y9k69l_84">conceptAlias</em>&nbsp;property:</p><figure id="-y9k69l_85"><img alt="Editor104.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor104.png" title="Editor104.png" width="573" height="86"></figure></section><section class="chapter"><h3 id="uniqueconstraint" data-toc="uniqueconstraint">Unique constraint</h3><p id="-y9k69l_86">In general, constraints allow you to restrict allowed nodes in roles and values for properties and report violations to the user.</p><figure id="-y9k69l_87"><img alt="Editor41.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor41.png" title="Editor41.png" width="211" height="122"></figure><figure id="-y9k69l_88"><img alt="Editor43.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor43.png" title="Editor43.png" width="168" height="92"></figure><p id="-y9k69l_89">Frequently you'd like to apply constraints to limit allowed values in your code. E.g. the names of method definitions should be unique, each library should be imported only once, etc. MPS gives you two options:</p><ol class="list _decimal" id="-y9k69l_90" type="1"><li class="list__item" id="-y9k69l_91"><p>Use <em id="-y9k69l_92">constraints</em>&nbsp;- these define hard validity rules for abstract syntax (structure) of your language. Use these if you want to disallow certain nodes or properties to be ever made part of the AST.</p></li><li class="list__item" id="-y9k69l_93"><p>Use <em id="-y9k69l_94">NonTypesystemRules</em>&nbsp;- these provide additional level of model verification. You are still allowed to enter incorrect values in the editor, but you will get an error message and a red underline that notifies you about the rule violation. Unlike with <em id="-y9k69l_95">constraints</em>&nbsp;you can also specify a custom error message with additional details to give the developer helpful hints.</p></li></ol><p id="-y9k69l_96"><em id="-y9k69l_97">Constraints</em></p><figure id="-y9k69l_98"><img alt="Editor42.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor42.png" title="Editor42.png" width="726" height="157"></figure><p id="-y9k69l_99"><em id="-y9k69l_100">NonTypesystemRules</em></p><figure id="-y9k69l_101"><img alt="Editor44.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor44.png" title="Editor44.png" width="769" height="282"></figure></section><section class="chapter"><h3 id="anindentedverticalcollection" data-toc="anindentedverticalcollection">An indented vertical collection</h3><p id="-y9k69l_102">Indent layout is the preferred choice instead of vertical/horizontal ones where applicable. To create an indented vertical collection you can create a <em id="-y9k69l_103">wrapping indent collection</em> (marked with [- &nbsp;-]) and set</p><ol class="list _decimal" id="-y9k69l_104" type="1"><li class="list__item" id="-y9k69l_105"><p>indent-layout-indent: true</p></li><li class="list__item" id="-y9k69l_106"><p>selectable : false. (false means the collection will be transparent when expanding code selection).</p></li></ol><p id="-y9k69l_107">Then, on the child collection use indent-layout-new-line-children : true.</p></section><section class="chapter"><h3 id="optionalvisibility" data-toc="optionalvisibility">Optional visibility</h3><p id="-y9k69l_108">Elements, that should only be visible under certain condition, should have its <em id="-y9k69l_109">show if</em>&nbsp;property set:</p><figure id="-y9k69l_110"><img alt="Editor16.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor16.png" title="Editor16.png" width="518" height="436"></figure></section><section class="chapter"><h3 id="definingandreusingstyles" data-toc="definingandreusingstyles">Defining and reusing styles</h3><p id="-y9k69l_111">Each cell can have its visual style defined in the <em id="-y9k69l_112">Inspector</em>. In addition to defining style properties individually, styles can be pre-defined and then reused by multiple languages.</p><figure id="-y9k69l_113"><img alt="Editor37.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor37.png" title="Editor37.png" width="366" height="149"></figure><figure id="-y9k69l_114"><img alt="Editor38.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor38.png" title="Editor38.png" width="369" height="117"></figure><p id="-y9k69l_115">You can define your own styles and make them part of your editor module so that they can be used in your editors as well as in all the editors that import your editor module.</p><figure id="-y9k69l_116"><img alt="Editor39.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor39.png" title="Editor39.png" width="395" height="222"></figure></section><section class="chapter"><h3 id="reusingthebaselanguagestyles" data-toc="reusingthebaselanguagestyles">Reusing the BaseLanguage styles</h3><p id="-y9k69l_117">BaseLanguage comes with a rich collection of pre-defined styles. All you need to do in order to be able to use the styles defined in another language is to import the language into the <b id="-y9k69l_118">editor of your language</b>.</p><figure id="-y9k69l_119"><img alt="Editor40.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor40.png" title="Editor40.png" width="500" height="599"></figure></section><section class="chapter"><h3 id="makingproperkeywords" data-toc="makingproperkeywords">Making proper keywords</h3><p id="-y9k69l_120">Keywords should have the <em id="-y9k69l_121">keyword</em>&nbsp;style applied so that they stand out in text. Also, making a keyword <em id="-y9k69l_122">editable</em>&nbsp;will make sure users can freely type inside or next to the keyword and have transforms applied. With <em id="-y9k69l_123">editable</em>&nbsp;set to <em id="-y9k69l_124">false</em>&nbsp;MPS will interfere with user's input and ignore characters, which don't match any applicable transformation.</p><figure id="-y9k69l_125"><img alt="Editor18.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor18.png" title="Editor18.png" width="770" height="291"></figure></section><section class="chapter"><h3 id="adjustabstractsyntaxforeasyediting" data-toc="adjustabstractsyntaxforeasyediting">Adjust abstract syntax for easy editing</h3><p id="-y9k69l_126">Making all concepts descent from the same (abstract) concept allows you to mix and match instances of these concepts in any order inside their container and so give the users a very text-like experience. Additionally, if you include concepts for empty lines and (line) comments, you will give your users the freedom to place comments and empty lines anywhere they feel fit.</p><figure id="-y9k69l_127"><img alt="Editor2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor2.png" title="Editor2.png" width="864" height="436"></figure><p id="-y9k69l_128">In our example, the <em id="-y9k69l_129">SStructureContainer</em>&nbsp;does not impose any order, in which the members should be placed. The allowed elements all descend from <em id="-y9k69l_130">SStructurePart</em>&nbsp;and so are all allowed children.</p></section><section class="chapter"><h3 id="specify,whichconceptshouldbethedefaultforlists" data-toc="specify,whichconceptshouldbethedefaultforlists">Specify, which concept should be the default for lists</h3><p id="-y9k69l_131">When you hit <em id="-y9k69l_132">Enter</em>&nbsp;in a text editor, you get a new line. Identically, you may want to an&nbsp;<em id="-y9k69l_133">empty line concept</em>&nbsp;or some other reasonable default concept of your language to be added to the list at the current caret position, when the user presses&nbsp;<em id="-y9k69l_134">Enter</em>.</p><p id="-y9k69l_135">The behavior in the second image below should be preferred to the one visible on the first one:</p><figure id="-y9k69l_136"><img alt="Editor5.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor5.png" title="Editor5.png" width="634" height="119"></figure><figure id="-y9k69l_137"><img alt="Editor6.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor6.png" title="Editor6.png" width="546" height="99"></figure><p id="-y9k69l_138">The red placeholder is caused by either a missing node in the position or an instance of an&nbsp;<b id="-y9k69l_139">abstract</b> concept. Since abstract concepts should not be instantiated, the editor always shows them in red.</p><p id="-y9k69l_140">When the user hits Enter on a collection cell a new node is created and inserted into the collection. The concept of the newly created and inserted node is the same as the declared concept of the collection. If the concept is&nbsp;<b id="-y9k69l_141">abstract</b>, the newly created and inserted node will be in instance of that abstract concept and thus rendered in red.</p><p id="-y9k69l_142">There are three ways to prevent such situations:</p><ol class="list _decimal" id="-y9k69l_143" type="1"><li class="list__item" id="-y9k69l_144"><p>Use a non-abstract concept to declare the concept of the child collection.&nbsp;<em id="-y9k69l_145">BaseLanguage</em> uses this approach for&nbsp;<em id="-y9k69l_146">Statement</em>, which is a common super-concept to all statements and is not abstract in order to represent empty lines.</p></li><li class="list__item" id="-y9k69l_147"><p>Specify a&nbsp;<b id="-y9k69l_148">default concrete concept</b> in the&nbsp;<em id="-y9k69l_149">Constraints</em> of the abstract concept. This will use the specified concrete concept whenever the abstract one is to be instantiated. Such a concrete concept will then be used as a concept for empty lines.</p></li><li class="list__item" id="-y9k69l_150"><p>Use&nbsp;<b id="-y9k69l_151">element factory</b> on all collections, in which a different than the abstract concept should be used for creating newly inserted nodes (described below).</p></li></ol><p id="-y9k69l_152">Specifying default concept is as easy as setting the <em id="-y9k69l_153">element factory</em>&nbsp;property of the collection editor:</p><figure id="-y9k69l_154"><img alt="Editor3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor3.png" title="Editor3.png" width="507" height="685"></figure></section><section class="chapter"><h3 id="makeemptylineshelpfultofurtherediting" data-toc="makeemptylineshelpfultofurtherediting">Make empty lines helpful to further editing</h3><p id="-y9k69l_155">Making empty lines to appear as default after hitting <em id="-y9k69l_156">Enter</em>&nbsp;is the first important step to mimic the behavior of text-editors. The next step that will get you even closer is to make empty lines react reasonably to user input and provide handy code completion.</p><figure id="-y9k69l_157"><img alt="Editor25.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor25.png" title="Editor25.png" width="461" height="450"></figure><p id="-y9k69l_158">You should make your empty lines similar to the one above - add an empty&nbsp;<em id="-y9k69l_159">constant</em>&nbsp;cell, make it <em id="-y9k69l_160">editable</em>&nbsp;and specify the <b id="-y9k69l_161">super-type</b> of all items to populate the <em id="-y9k69l_162">code-completion</em> menu with. If you followed the earlier advice and have all your concepts, which could take the position of the empty line, descend from a common ancestor, this is the type to benefit. Specify that ancestor as the concept to potentially replace empty lines with.</p></section><section class="chapter"><h3 id="hidingconceptsfromthecompletionmenu" data-toc="hidingconceptsfromthecompletionmenu">Hiding concepts from the completion menu</h3><p id="-y9k69l_163">The completion menu can be customized using the <a href="transformation-menu-language.html" id="-y9k69l_164">Transformation Menu language</a>. By default it shows all non-abstract concepts that can be substituted in the current location. Some concepts, such as empty lines or comments, you may want to exclude from the completion menu explicitly. To do so, you need to define a&nbsp;<em id="-y9k69l_165">Default Substitute Menu</em> for the concerned concept or its super-concept in the editor aspect of your language and leave it empty. MPS uses that menu to populate the completion menu with items whenever your concept is considered for substitution. Leaving the menu empty will result in your concept never getting inserted into the completion menu.</p></section><section class="chapter"><h3 id="easynodereplacement" data-toc="easynodereplacement">Easy node replacement</h3><p id="-y9k69l_166">Similarly, you will frequently want to allow developers to replace one node with another in-place, just by typing the name of the new element:</p><figure id="-y9k69l_167"><img alt="Editor26.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor26.png" title="Editor26.png" width="519" height="212"></figure><p id="-y9k69l_168">Just like with empty lines, for this to work, you set the replacement concept to the common ancestor of all the applicable candidate concepts. These will then appear in the code-completion menu.</p><figure id="-y9k69l_169"><img alt="Editor27.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor27.png" title="Editor27.png" width="456" height="392"></figure></section><section class="chapter"><h3 id="verticalspaceseparators" data-toc="verticalspaceseparators">Vertical space separators</h3><p id="-y9k69l_170">To create some vertical space in order to separate elements, <em id="-y9k69l_171">constant</em>&nbsp;cells are very handy to utilize. Give them empty contents, set <em id="-y9k69l_172">noAttraction</em>&nbsp;for focus to make it transparent and put it on a separate line with <em id="-y9k69l_173">indent-layout-new-line</em>.</p><figure id="-y9k69l_174"><img alt="Editor4.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor4.png" title="Editor4.png" width="436" height="475"></figure></section><section class="chapter"><h3 id="handlingemptyvaluesinconstants" data-toc="handlingemptyvaluesinconstants">Handling empty values in constants</h3><p id="-y9k69l_175">A value of a property can may either hold a value or be empty. MPS gives you three knobs to tune the editor to react properly to empty values.&nbsp;Depending on the values of the <em id="-y9k69l_176">allow-empty</em>, <em id="-y9k69l_177">text*</em>&nbsp;and <em id="-y9k69l_178">empty text*</em>&nbsp;flags, the editor cell may or may not turn red or display a custom message when the property is empty.</p><div class="table-wrapper"><table class="wide" id="-y9k69l_179"><thead><tr class="ijRowHead" id="-y9k69l_180"><th id="-y9k69l_181"><p id="-y9k69l_182">Empty values not allowed.</p><p id="-y9k69l_183">The cell is displayed in red to indicate an error.</p></th><th id="-y9k69l_184"><figure id="-y9k69l_185"><img alt="Editor19a.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor19a.png" title="Editor19a.png" width="335" height="57"></figure></th><th id="-y9k69l_186"><figure id="-y9k69l_187"><img alt="Editor19b.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor19b.png" title="Editor19b.png" width="202" height="107"></figure></th></tr></thead><tbody><tr id="-y9k69l_188"><td id="-y9k69l_189"><p id="-y9k69l_190">Empty values not allowed.</p><p id="-y9k69l_191">A custom message has been provided to empty cells.</p></td><td id="-y9k69l_192"><figure id="-y9k69l_193"><img alt="Editor24a.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor24a.png" title="Editor24a.png" width="428" height="45"></figure></td><td id="-y9k69l_194"><figure id="-y9k69l_195"><img alt="Editor24b.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor24b.png" title="Editor24b.png" width="311" height="100"></figure></td></tr><tr id="-y9k69l_196"><td id="-y9k69l_197"><p id="-y9k69l_198">Empty values are allowed.</p><p id="-y9k69l_199">An empty cell displays a default message in gray color.</p></td><td id="-y9k69l_200"><figure id="-y9k69l_201"><img alt="Editor20a.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor20a.png" title="Editor20a.png" width="362" height="41"></figure></td><td id="-y9k69l_202"><figure id="-y9k69l_203"><img alt="Editor20b.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor20b.png" title="Editor20b.png" width="190" height="103"></figure></td></tr><tr id="-y9k69l_204"><td id="-y9k69l_205"><p id="-y9k69l_206">Empty values are allowed.</p><p id="-y9k69l_207">A custom message has been provided to empty cells.</p></td><td id="-y9k69l_208"><figure id="-y9k69l_209"><img alt="Editor21a.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor21a.png" title="Editor21a.png" width="430" height="45"></figure></td><td id="-y9k69l_210"><figure id="-y9k69l_211"><img alt="Editor21b.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor21b.png" title="Editor21b.png" width="294" height="100"></figure></td></tr><tr id="-y9k69l_212"><td id="-y9k69l_213"><p id="-y9k69l_214">Empty values are allowed.</p><p id="-y9k69l_215">The empty cell is visually transparent.</p></td><td id="-y9k69l_216"><figure id="-y9k69l_217"><img alt="Editor22a.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor22a.png" title="Editor22a.png" width="265" height="40"></figure></td><td id="-y9k69l_218"><figure id="-y9k69l_219"><img alt="Editor22b.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor22b.png" title="Editor22b.png" width="185" height="98"></figure></td></tr><tr id="-y9k69l_220"><td id="-y9k69l_221"><p id="-y9k69l_222">Empty values not allowed.</p><p id="-y9k69l_223">The empty value has no default text and is marked in red.</p></td><td id="-y9k69l_224"><figure id="-y9k69l_225"><img alt="Editor23a.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor23a.png" title="Editor23a.png" width="260" height="41"></figure></td><td id="-y9k69l_226"><figure id="-y9k69l_227"><img alt="Editor23b.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor23b.png" title="Editor23b.png" width="173" height="94"></figure></td></tr></tbody></table></div></section><section class="chapter"><h3 id="horizontallistseparator" data-toc="horizontallistseparator">Horizontal list separator</h3><p id="-y9k69l_228">The <em id="-y9k69l_229">separator</em>&nbsp;property on collection cells allows you to pick a character that will</p><ol class="list _decimal" id="-y9k69l_230" type="1"><li class="list__item" id="-y9k69l_231"><p>Visually separate elements of the list</p></li><li class="list__item" id="-y9k69l_232"><p>Allow the user to append or insert new elements into the list</p></li></ol><figure id="-y9k69l_233"><img alt="Editor7.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor7.png" title="Editor7.png" width="386" height="292"></figure><figure id="-y9k69l_234"><img alt="Editor8.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor8.png" title="Editor8.png" width="690" height="228"></figure><p id="-y9k69l_235">Although separators can be any string values, it is more convenient to keep them at one character length.</p></section><section class="chapter"><h3 id="matchingbracesandparentheses" data-toc="matchingbracesandparentheses">Matching braces and parentheses</h3><p id="-y9k69l_236">Use the <em id="-y9k69l_237">matching-label</em>&nbsp;property to pair braces and parentheses. This gives the users the ability to quickly visualize the wrapped block of code and its boundaries:</p><figure id="-y9k69l_238"><img alt="Editor9.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor9.png" title="Editor9.png" width="456" height="113"></figure><figure id="-y9k69l_239"><img alt="Editor10.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor10.png" title="Editor10.png" width="362" height="281"></figure><p id="-y9k69l_240">Since MPS 3.4 you can also use <em id="-y9k69l_241">show-boundaries-in</em> style on a collection cell to specify how its boundaries are to be shown. The style has two values, <em id="-y9k69l_242">gutter</em> and <em id="-y9k69l_243">gutter-and-editor</em>. If you set the style of a collection to <em id="-y9k69l_244">gutter-and-editor</em>, the collection's first and last cell will be highlighted in the editor when one of the cells is selected and a bracket will be shown in the left-hand editor gutter. Setting the style to&nbsp;<em id="-y9k69l_245">gutter</em> will only show the bracket and may be useful if you want to show where a particular collection begins and ends but there isn't a well-defined last cell in the collection.</p><p id="-y9k69l_246">Example:</p><figure id="-y9k69l_247"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/image2016-7-26-11-7-5.png" class="lightbox"><img alt="image2016-7-26-11-7-5.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/image2016-7-26-11-7-5.png" title="image2016-7-26-11-7-5.png" width="376" height="376"></a></figure><p id="-y9k69l_248">The result:</p><figure id="-y9k69l_249"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/image2016-7-26-11-9-21.png" class="lightbox"><img alt="image2016-7-26-11-9-21.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/image2016-7-26-11-9-21.png" title="image2016-7-26-11-9-21.png" width="245" height="142"></a></figure></section><section class="chapter"><h3 id="emptyblocksshouldlookempty" data-toc="emptyblocksshouldlookempty">Empty blocks should look empty</h3><p id="-y9k69l_250">By default an empty block always takes one line of the vertical real-estate. It also contains a default empty cell, which gives the developer a hint that there's a list she can add elements to.</p><figure id="-y9k69l_251"><img alt="Editor14.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor14.png" title="Editor14.png" width="410" height="56"></figure><p id="-y9k69l_252">You may hide the <em id="-y9k69l_253">&lt;&lt; ... &gt;&gt;</em>&nbsp;characters by&nbsp;setting the <em id="-y9k69l_254">empty cell</em>&nbsp;value to be an empty <em id="-y9k69l_255">constant</em> cell, which gives you a slightly more text-like look:</p><figure id="-y9k69l_256"><img alt="Editor11.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor11.png" title="Editor11.png" width="420" height="54"></figure><p id="-y9k69l_257">One additional trick will hide the empty line altogether:</p><figure id="-y9k69l_258"><img alt="Editor12.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor12.png" title="Editor12.png" width="418" height="36"></figure><p id="-y9k69l_259">What you need to do is to conditionally alter the <em id="-y9k69l_260">indent-layout-new-line</em>&nbsp;and the <em id="-y9k69l_261">punctuation-right</em>&nbsp;properties&nbsp;of the opening brace to add/remove a new line after the brace and assign control of the caret position right after the brace to the following cell. Since the <em id="-y9k69l_262">empty constant cell</em>&nbsp;for the <em id="-y9k69l_263">members</em>&nbsp;collection follows and is editable, it will receive all keyboard input at the position right after the brace.&nbsp;This will allow the developer to type without starting a new empty line first.</p><figure id="-y9k69l_264"><img alt="Editor-fix3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor-fix3.png" title="Editor-fix3.png" width="640" height="365"></figure></section><section class="chapter"><h3 id="makeemptyconstantseditable" data-toc="makeemptyconstantseditable">Make empty constants editable</h3><p id="-y9k69l_265">It is advisable to represent empty cells for collections with empty constant values that have the <em id="-y9k69l_266">editable</em>&nbsp;property set to <em id="-y9k69l_267">true</em>. This way users will be able to start typing without first creating a new collection element (via <em id="-y9k69l_268">Enter</em>&nbsp;or the <em id="-y9k69l_269">separator key</em>).</p><figure id="-y9k69l_270"><img alt="Editor17.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor17.png" title="Editor17.png" width="365" height="128"></figure></section></section><section class="chapter"><h2 id="commoneditorpatterns" data-toc="commoneditorpatterns">Common editor patterns</h2><section class="chapter"><h3 id="prependingflagkeywords" data-toc="prependingflagkeywords">Prepending flag keywords</h3><p id="-y9k69l_271">Marker keywords prepending the actual concept, such as <em id="-y9k69l_272">final</em>, <em id="-y9k69l_273">abstract</em>&nbsp;or <em id="-y9k69l_274">public</em>&nbsp;in Java,&nbsp;are quite common in programming languages.</p><p> private abstract class MyCalculator { ... } </p><p id="-y9k69l_275">Developers have certain expectations of how these can be added, modified or deleted from code and projectional editors should follow some rules to achieve pleasant intuitiveness and convenience levels.</p><ul class="list _bullet" id="-y9k69l_276"><li class="list__item" id="-y9k69l_277"><p>Typing part of the keyword anywhere to the left of the main concept name should insert the keyword</p></li><li class="list__item" id="-y9k69l_278"><p>Hitting <em id="-y9k69l_279">delete</em>&nbsp;while positioned on the keyword should remove it</p></li><li class="list__item" id="-y9k69l_280"><p>The keyword should only be visible when the associated flag is <em id="-y9k69l_281">true</em>&nbsp;- for example, the <em id="-y9k69l_282">final</em>&nbsp;keyword is only shown for <em id="-y9k69l_283">final</em>&nbsp;classes in Java</p></li></ul><p id="-y9k69l_284">Notice that the keywords are optional, with the <em id="-y9k69l_285">show if</em>&nbsp;condition querying the underlying abstract model.</p><figure id="-y9k69l_286"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Flags1.png" class="lightbox"><img alt="Flags1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Flags1.png" title="Flags1.png" width="500" height="206"></a></figure><p id="-y9k69l_287">The <em id="-y9k69l_288">action map</em>&nbsp;property refers to an action map, which specifies that when the <em id="-y9k69l_289">DELETE</em>&nbsp;action is invoked (perhaps by pressing the <em id="-y9k69l_290">delete</em>&nbsp;key), the underlying abstract model should be updated, which will in turn make the flag keyword disappear from the screen.</p><figure id="-y9k69l_291"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Flags2.png" class="lightbox"><img alt="Flags2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Flags2.png" title="Flags2.png" width="500" height="145"></a></figure><p id="-y9k69l_292">Notice that the&nbsp;<em id="-y9k69l_293">aproveDelete</em> call gives the user a chance to revoke her decision to delete the flag and also how positioning the &nbsp;cursor after deleting the flag is handled.</p><p id="-y9k69l_294">To allow the developers to add the keyword just by typing it, we need to define a <em id="-y9k69l_295">left transform action</em>, which, in our example, when applied to a non-final element will make the element final after typing "final" or any unique prefix of it. The&nbsp;<em id="-y9k69l_296">Transformation Menu language</em> gives us&nbsp;<b id="-y9k69l_297">Transformation Menus</b>, which we can utilize here:</p><figure id="-y9k69l_298"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Flags3.png" class="lightbox"><img alt="Flags3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Flags3.png" title="Flags3.png" width="500" height="353"></a></figure><p id="-y9k69l_299">A&nbsp;<em id="-y9k69l_300">Named transformation menu</em> can then be attached to the editor cells that precede or succeed our flag cell:</p><figure id="-y9k69l_301"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Flags4.png" class="lightbox"><img alt="Flags4.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Flags4.png" title="Flags4.png" width="500" height="166"></a></figure></section><section class="chapter"><h3 id="appendingparametrizedkeywords" data-toc="appendingparametrizedkeywords">Appending parametrized keywords</h3><p id="-y9k69l_302">Supporting keywords similar to Java's <em id="-y9k69l_303">implements</em>&nbsp;is also very straightforward in MPS.</p><figure id="-y9k69l_304"><img alt="Editor30.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor30.png" title="Editor30.png" width="520" height="133"></figure><p id="-y9k69l_305">First, the whole <em id="-y9k69l_306">implements A, B C</em>&nbsp;part must be optionally visible.</p><figure id="-y9k69l_307"><img alt="Editor36.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor36.png" title="Editor36.png" width="993" height="395"></figure><p id="-y9k69l_308">Only when the list of implemented interfaces is non-empty, the collection including the <em id="-y9k69l_309">implements</em>&nbsp;keyword is displayed.</p><p id="-y9k69l_310">Second, we need a right transformation to add a new child into the <em id="-y9k69l_311">implements</em>&nbsp;collection, when <em id="-y9k69l_312">implements</em>&nbsp;or a part of it is typed right after the class name or after the reference to the <em id="-y9k69l_313">extended</em>&nbsp;class. Similarly, a left transformation is needed to add a new child when <em id="-y9k69l_314">implements</em>&nbsp;is typed right before the code block's left brace. Again, the&nbsp;<em id="-y9k69l_315">Transformation Menu language</em> will let us create named transformation menus and attach them to the cells.</p></section><section class="chapter"><h3 id="nodesubstitutionactions" data-toc="nodesubstitutionactions">Node substitution actions</h3><p id="-y9k69l_316"><em id="-y9k69l_317">Node substitution actions</em>&nbsp;specify how certain nodes can be replaced with others. For example, you may want to change logical <b id="-y9k69l_318">and</b>&nbsp;to <b id="-y9k69l_319">or</b>&nbsp;and vice versa, yet preserve the boolean conditions specified in the child nodes:</p><figure id="-y9k69l_320"><img alt="Editor105.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor105.png" title="Editor105.png" width="492" height="90"></figure><p id="-y9k69l_321">Let's use <b id="-y9k69l_322">Default substitute menu</b>&nbsp;from <em id="-y9k69l_323">Transformation Menu language</em>:</p><figure id="-y9k69l_324"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Subst1.png" class="lightbox"><img alt="Subst1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Subst1.png" title="Subst1.png" width="500" height="190"></a></figure><p id="-y9k69l_325">Since both <em id="-y9k69l_326">And</em>&nbsp;and <em id="-y9k69l_327">Or</em>&nbsp;concepts inherit from <em id="-y9k69l_328">LogicalOperator</em>, we can refer to <em id="-y9k69l_329">LogicalOperator</em>&nbsp;in the action. In essence, the action above allows replacing any <em id="-y9k69l_330">LogicalOperator</em>&nbsp;with any <b id="-y9k69l_331">non-abstract</b>&nbsp;subconcept of <em id="-y9k69l_332">LogicalOperator</em>. The replacing concept is instantiated and its <em id="-y9k69l_333">left</em>&nbsp;and <em id="-y9k69l_334">right</em>&nbsp;children populated from the children of the node that is being replaced.</p></section><section class="chapter"><h3 id="substitutionforcustomstringvalues" data-toc="substitutionforcustomstringvalues">Substitution for custom string values</h3><p id="-y9k69l_335">Substitution rules can also be used to convert plain strings into nodes of a desired concept. Imagine, for example, a kind of variable declaration that starts with the name of the variable, like in Python:</p></section></section><div class="code-block" data-lang="plaintext">myVariable = 10;</div><p id="-y9k69l_337">To enter such variable declaration, you can always pick the variable concept (by its alias) from the completion menu and then fill in the name:</p><figure id="-y9k69l_338"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/var1.png" class="lightbox"><img alt="var1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/var1.png" title="var1.png" width="500" height="92"></a></figure><figure id="-y9k69l_339"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/var2.png" class="lightbox"><img alt="var2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/var2.png" title="var2.png" width="300" height="99"></a></figure><figure id="-y9k69l_340"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/var3.png" class="lightbox"><img alt="var3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/var3.png" title="var3.png" width="300" height="109"></a></figure><p id="-y9k69l_341">You can, however, add a simple substitution action into the substitution menu that will enable users to simply type the desired name of the variable on the empty line and have the variable created for you automatically:</p><figure id="-y9k69l_342"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/var5.png" class="lightbox"><img alt="var5.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/var5.png" title="var5.png" width="300" height="147"></a></figure><figure id="-y9k69l_343"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/var6.png" class="lightbox"><img alt="var6.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/var6.png" title="var6.png" width="300" height="116"></a></figure><p id="-y9k69l_344">The menu may look something like this:</p><figure id="-y9k69l_345"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/var7.png" class="lightbox"><img alt="var7.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/var7.png" title="var7.png" width="500" height="163"></a></figure><ol class="list _decimal" id="-y9k69l_346" type="1"><li class="list__item" id="-y9k69l_347"><p>It can be substituted whenever a non-empty pattern has been typed and it does not match an alias of any of the known sub-concepts applicable in the position</p></li><li class="list__item" id="-y9k69l_348"><p>A new node is created when the action is run and the pattern is copied into the name of the variable</p></li><li class="list__item" id="-y9k69l_349"><p>The "selection handler" ensures that the cursor stays within the "name" cell after creating the variable so that the user can continue typing the name even after the variable has already been created (it is created as soon as there is no other option in the completion menu (the "selection handler" returns null, since when a non-null node is returned, MPS places the caret itself on the returned node and ignores the "select" command)</p></li></ol><p id="-y9k69l_350">You may also experiment with checking the "strictly" flag to further customize the behavior:</p><figure id="-y9k69l_351"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/var4.png" class="lightbox"><img alt="var4.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/var4.png" title="var4.png" width="500" height="90"></a></figure><p id="-y9k69l_352">Here's the menu:</p><figure id="-y9k69l_353"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/var8.png" class="lightbox"><img alt="var8.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/var8.png" title="var8.png" width="500" height="219"></a></figure><p id="-y9k69l_354">Changes:</p><ol class="list _decimal" id="-y9k69l_355" type="1"><li class="list__item" id="-y9k69l_356"><p>The <b id="-y9k69l_357">description</b> provides a customized description message to display in the completion menu alongside the "variable" alias</p></li><li class="list__item" id="-y9k69l_358"><p>The&nbsp;<b id="-y9k69l_359">pattern</b> ensures the so far typed text is suggested as the name of the variable to be created (when the code-completion menu is visible)</p></li><li class="list__item" id="-y9k69l_360"><p>The&nbsp;<b id="-y9k69l_361">can substitute</b> handler reacts to the value of the&nbsp;<em id="-y9k69l_362">strictly</em> parameter, so that as long as there are other subconcepts available in the menu this action is also available, but only for non-strict matching.</p></li></ol><aside class="prompt" data-type="tip" data-title="" id="-y9k69l_363"><p id="-y9k69l_364">The "strictly" parameter is set to "true" when MPS is detecting whether your action perfectly matches the text typed so far. This gives actions the ability to distinguish between two situations:</p><ol class="list _decimal" id="-y9k69l_365" type="1"><li class="list__item" id="-y9k69l_366"><p>The "pattern" is a prefix of what the action reacts to and so it wants to stay in the menu</p></li><li class="list__item" id="-y9k69l_367"><p>The "pattern" is an exact match of what the action reacts to and so if there are no other options in the completion menu, the action should be triggered instantly</p></li></ol><p id="-y9k69l_368">If your action is the only item in the completion menu and the "can substitute" function of your action, when called with "strictly==true", returns true, the action is performed. By always returning "false" for "strictly==true" you ensure that the action never matches strictly (perfectly) the pattern and so the variable is only created when the user explicitly triggers the action (Control+Space, Enter). In that case the "selection handler" can let the caret move to the initializer, since the user has already finished typing the name of the variable, anyway.</p></aside><section class="chapter"><h2 id="includingparentstransformactions" data-toc="includingparentstransformactions">Including parents transform actions</h2><p id="-y9k69l_369">Your nodes can optionally include transform actions applicable to different nodes, e.g. parents. For example, if we allow for appending <b id="-y9k69l_370">logical and</b>&nbsp;and <b id="-y9k69l_371">or</b>&nbsp;to logical expressions, we may still get into problems when the logical expression is more complex and, for example, the last cell of its editor belongs to a child node.</p><figure id="-y9k69l_372"><img alt="Editor110.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Editor110.png" title="Editor110.png" width="505" height="115"></figure><p id="-y9k69l_373">In our example, <em id="-y9k69l_374">heading south</em>&nbsp;is a logical expression, however, <em id="-y9k69l_375">south</em>&nbsp;itself is a child of logical expression with a concept <em id="-y9k69l_376">Direction</em>. Thus the original right transform action that accepts <b id="-y9k69l_377">and</b>&nbsp;and <b id="-y9k69l_378">or</b>&nbsp;to be appended to logical expression will not work here. We must include the original right transform (applicable to <em id="-y9k69l_379">Heading</em> )&nbsp;action into a new right transform action applicable to <em id="-y9k69l_380">Direction</em>&nbsp;specifically.</p><figure id="-y9k69l_381"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/Inherit1.png" class="lightbox"><img alt="Inherit1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Inherit1.png" title="Inherit1.png" width="500" height="122"></a></figure></section><section class="chapter"><h2 id="conceptualquestions" data-toc="conceptualquestions">Conceptual questions</h2><section class="chapter"><h3 id="extendinganexistingeditor" data-toc="extendinganexistingeditor">Extending an existing editor</h3><p id="-y9k69l_382">The MPS editor assigns visual cells to nodes from the model and so delegates to the node's concept the responsibility for redering the coresponding values and accepting user input. This mechanism will work irrespective of the language the concepts has been defined in. So an embedded language such as, e.g. a math formula, will render itself correctly, no matter whether it is part of a Java program or an electrical circuit simulation model, for example.</p><p id="-y9k69l_383">New sub-concepts will by default re-use the editor of their parent concept, unless a specific editor is available. On the other hand extending languages may supply their own editors for inherited concepts and thus override the concrete syntax derived from the inherited editor.</p></section><section class="chapter"><h3 id="designaneditorforextension" data-toc="designaneditorforextension">Design an editor for extension</h3><p id="-y9k69l_384">A good strategy is to use <em id="-y9k69l_385">Editor components</em>&nbsp;to modularize the editor. This will allow language extensions to override the components without having to redefine the editor itself.</p><p id="-y9k69l_386">References to properties, such as <em id="-y9k69l_387">conceptAlias</em>, from within the editor should be preferred to hardcoded literals, since the reference will allow the editor to adapt to the subconcepts without having the override the editor.</p><p id="-y9k69l_388">When specifying actions' and intentions' applicability rules, bear in mind that some subconcepts may need to opt out from these actions of their parent. Making these actions check a behavior method in their applicability rules is advisable in such scenarios.</p></section><section class="chapter"><h3 id="howtoaddarefactoringtothemenu" data-toc="howtoaddarefactoringtothemenu">How to add a refactoring to the menu</h3><p id="-y9k69l_389">Use <em id="-y9k69l_390">InlineField</em>&nbsp;or <em id="-y9k69l_391">IntroduceVariable</em>&nbsp;as good examples. In general, you need to define an <em id="-y9k69l_392">Action</em>&nbsp;from the&nbsp;<em id="-y9k69l_393">jetbrains.mps.lang.plugin</em>&nbsp;language, which specifies its applicability, collects contextual information and the user input, initializes the actual refactoring procedure and invokes it. The refactoring functionality is typically extracted into a <em id="-y9k69l_394">BaseLanguage</em>&nbsp;class and potentially reused by multiple actions.</p></section></section><section class="chapter"><h2 id="howtodefinemultipleeditorsforthesameconcept" data-toc="howtodefinemultipleeditorsforthesameconcept">How to define multiple editors for the same concept</h2><section class="chapter"><h3 id="asamplefirst" data-toc="asamplefirst">A sample first</h3><p id="-y9k69l_395">The <b id="-y9k69l_396">MultipleProjections</b>&nbsp;sample project bundled with MPS provides good introductory guidelines to learn how to define multiple editors per concepts and how to allow switching between them.</p><figure id="-y9k69l_397"><img alt="mp1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp1.png" title="mp1.png" width="656" height="610"></figure><p id="-y9k69l_398">The sample languages allow you to define workflows, which consist of one or more state machines. State machines can be expressed either structurally or as tables. The programmer can switch between notations used for each state machine simply by typing either <em id="-y9k69l_399">structural</em>&nbsp;or <em id="-y9k69l_400">tabular</em>&nbsp;at the beginning of the corresponding state machine definition:</p><figure id="-y9k69l_401"><img alt="mp2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp2.png" title="mp2.png" width="1098" height="395"></figure><p id="-y9k69l_402">The sample consists of three languages and a sandbox project.</p><figure id="-y9k69l_403"><img alt="mp3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp3.png" title="mp3.png" width="545" height="666"></figure><p id="-y9k69l_404">The <em id="-y9k69l_405">requestTracking</em>&nbsp;language provides the concepts and root concepts to wrap state machines and use them to define simple workflows. This could serve as an example of language that needs to embed a state machine language and allow for alternative notations for that embedded language.</p><p id="-y9k69l_406">The <em id="-y9k69l_407">stateMachine</em>&nbsp;language defines the basic concepts of the state machine language plus default editors. It has no artifacts specific to multiple projections at all. To illustrate the power of language extension in MPS the alternative editor projections for some of the concepts have been defined in <em id="-y9k69l_408">stateMachine.tabular</em>, which extends <em id="-y9k69l_409">stateMachine</em>.</p><figure id="-y9k69l_410"><img alt="mp5.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp5.png" title="mp5.png" width="525" height="243"></figure><figure id="-y9k69l_411"><img alt="mp4.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp4.png" title="mp4.png" width="475" height="205"></figure><p id="-y9k69l_412">While the default editors specified in&nbsp;<em id="-y9k69l_413">stateMachine</em>&nbsp;indicate the fact of being default with the&nbsp;<em id="-y9k69l_414">default</em>&nbsp;value in the upper-left corner, the editors in&nbsp;<em id="-y9k69l_415">stateMachine.tabular</em>&nbsp;specify the&nbsp;<em id="-y9k69l_416">tabular</em>&nbsp;<b id="-y9k69l_417">hint</b>. Specifying multiple hints for a single editor is also possible:</p><figure id="-y9k69l_418"><img alt="mp6.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp6.png" title="mp6.png" width="572" height="144"></figure></section><section class="chapter"><h3 id="hints" data-toc="hints">Hints</h3><p id="-y9k69l_419">The key element in choosing the right projection are <em id="-y9k69l_420">Hints</em>. Editors specify, which hints will trigger them to show up on the screen. Hints are <b id="-y9k69l_421">defined</b>&nbsp;using the new <em id="-y9k69l_422">ConceptEditorContextHints</em>&nbsp;concept.</p><figure id="-y9k69l_423"><img alt="mp7.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp7.png" title="mp7.png" width="575" height="178"></figure><p id="-y9k69l_424">This concept lets you define the <em id="-y9k69l_425">ID</em> and a short description for each hint recognized in the particular language or in a language that explicitly extends this language. So in our sample project, <em id="-y9k69l_426">stateMachine</em>&nbsp;and <em id="-y9k69l_427">stateMachine.tabular</em>&nbsp;both define their own set of hints.</p><figure id="-y9k69l_428"><img alt="mp8.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp8.png" title="mp8.png" width="1128" height="302"></figure><p id="-y9k69l_429">Notice also the <b id="-y9k69l_430">Can be used as a default hint</b>&nbsp;flag that can be set in the inspector. When set to true, the hint will be available to be pushed to editors from the IDE. See the details below, in the "Pushing hints from the IDE" section.</p><p id="-y9k69l_431">With hints defined, languages can offer the user to switch between notations by <b id="-y9k69l_432">adding/removing hints into/from</b> the context. The sample <em id="-y9k69l_433">requestTracking</em>&nbsp;language does it by exposing a <em id="-y9k69l_434">presentation</em>&nbsp;property of an enumeration type to the user. The property influences the collection of hints passed down into the <em id="-y9k69l_435">state machine</em>&nbsp;editor, as specified in the inspector window:</p><figure id="-y9k69l_436"><img alt="mp9.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp9.png" title="mp9.png" width="1484" height="519"></figure></section><section class="chapter"><h3 id="editorhintsforeditorcomponents" data-toc="editorhintsforeditorcomponents">Editor hints for Editor Components</h3><p id="-y9k69l_437">Not only editors can have hints specified. Editor Components that&nbsp;<b id="-y9k69l_438">override</b> other editor components have the same capability.</p><figure id="-y9k69l_439"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/HintsInComponents1.png" class="lightbox"><img alt="HintsInComponents1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/HintsInComponents1.png" title="HintsInComponents1.png" width="900" height="225"></a></figure></section><section class="chapter"><h3 id="pushinghintsfromtheide" data-toc="pushinghintsfromtheide">Pushing hints from the IDE</h3><p id="-y9k69l_440">The hints that have the "Can be used as a default hint" flag enabled, can be pushed by the IDE to the editors as the new defaults. This allows the developers to customize the default projection used for different languages in their IDEs.</p><p id="-y9k69l_441">One way to customize the projection is to use the <b id="-y9k69l_442">Push Editor Hints</b> <b id="-y9k69l_443"><em id="-y9k69l_444"></em></b> action in the editor context menu and select the hints that you want to be pushed as defaults to the active editor frame:</p><figure id="-y9k69l_445"><img alt="mp10.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp10.png" title="mp10.png" width="300" height="341"></figure><figure id="-y9k69l_446"><img alt="mp11.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp11.png" title="mp11.png" width="358" height="385"></figure><p id="-y9k69l_447">The active editors will then use projections that match the selected hints.</p><p id="-y9k69l_448">The second option is to make some hints pushed by the IDE through the corresponding&nbsp;<em id="-y9k69l_449">Settings</em>&nbsp;panel.&nbsp;These choices are then applied to all editor windows as default preferences.</p><figure id="-y9k69l_450"><img alt="mp12.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp12.png" title="mp12.png" width="734" height="248"></figure><p id="-y9k69l_451">You may consider combining the ability to switch between notations with splitting the editor frame. This allows you to lay several different projections of the same piece of code displayed next to one-another. Your changes in one will be immediately reflected in the other:</p><figure id="-y9k69l_452"><img alt="mp13.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mp13.png" title="mp13.png" width="1138" height="639"></figure><p id="-y9k69l_453">The right panel has the <em id="-y9k69l_454">tabular</em>&nbsp;notation pushed as the default, which the left panel does not. Both projections visualize the same code.</p><aside class="prompt" data-type="tip" data-title="" id="-y9k69l_455"><p id="-y9k69l_456">You may like watching <a href="http://www.youtube.com/watch?v=j1iPF2JjzuU" id="-y9k69l_457" data-external="true" rel="noopener noreferrer">a short screencast</a> showing this sample in action.</p></aside></section></section><section class="chapter"><h2 id="howtomanipulateandapplyeditorhintsprogrammatically" data-toc="howtomanipulateandapplyeditorhintsprogrammatically">How to manipulate and apply editor hints programmatically</h2><p id="-y9k69l_458">If you want to create your own UI elements that will adjust editor hints, you'll need to write code that will manipulate the editor hints applied to editor cells.&nbsp;<em id="-y9k69l_459">EditorContext</em> is the entry point for manipulating the hints. You'll need to obtain a&nbsp;<em id="-y9k69l_460">jetbrains.mps.openapi.editor.update.Updater</em> interface implementation, most likely using the&nbsp;<em id="-y9k69l_461">EditorComponent.getUpdater()</em> method. The&nbsp;<em id="-y9k69l_462">Updater</em> interface provides several methods for manipulating hints:</p><ul class="list _bullet" id="-y9k69l_463"><li class="list__item" id="-y9k69l_464"><p><em id="-y9k69l_465">setInitialEditorHints()</em> - sets the hints that the editor will start applying from the top of the editor component hierarchy down to all of the components, unless they explicitly remove these hints from the context, returns true if the hints actually changed as a result of this operation</p></li><li class="list__item" id="-y9k69l_466"><p><em id="-y9k69l_467">getInitialEditorHints()</em> - gets the hints the editor applies to all cells, may return null</p></li><li class="list__item" id="-y9k69l_468"><p><em id="-y9k69l_469">addExplicitEditorHintsForNode()</em> - adds hints to apply to a particular node's editor and the editors it embeds</p></li><li class="list__item" id="-y9k69l_470"><p><em id="-y9k69l_471">removeExplicitEditorHintsForNode</em> - removes the specified hints from the list of hints explicitly applied to the node's editor and the editors it embeds</p></li><li class="list__item" id="-y9k69l_472"><p><em id="-y9k69l_473">getExplicitEditorHintsForNode</em> - gets the list hints&nbsp;of hints explicitly applied to the node's editor and the editors it embeds, may return null</p></li><li class="list__item" id="-y9k69l_474"><p><em id="-y9k69l_475">clearExplicitHints</em> - clears all explicitly specified hints for all editors</p></li></ul><p id="-y9k69l_476">In order to get all hints applied to a particular cell, including the hints added by any of the parent cells, the <em id="-y9k69l_477">CellContext</em> must be retrieved, most likely as:</p><p id="-y9k69l_478"><em id="-y9k69l_479">editorContext.getEditorComponent().getUpdater().getCurrentUpdateSession().getCellFactory().getCellContext().getHints()</em></p><p id="-y9k69l_480">Also, after changing the hints, the editor needs to be rebuilt in order to reflect the changes. This can be done through the&nbsp;<em id="-y9k69l_481">Updater.update()</em>&nbsp;method.</p><aside class="prompt" data-type="tip" data-title="" id="-y9k69l_482"><p id="-y9k69l_483">The <b id="-y9k69l_484">multipleProjections</b> sample project contains three sample intentions that programmatically manipulate editor hints applied to the editor. For more information, refer to the sample.</p></aside></section><div class="last-modified">Last modified: 11 February 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="generator-cookbook.html" class="navigation-links__prev">Generator cookbook</a><a href="dive-into-plugins-the-plantmps-plugin.html" class="navigation-links__next">Dive into plugins: the PlantMPS plugin</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/storage/help-app/v6/app.js"></script></body></html>
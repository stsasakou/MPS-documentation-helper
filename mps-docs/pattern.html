<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><link rel="canonical" href="https://www.jetbrains.com/help/mps/pattern.html" data-react-helmet="true"/><meta charset="UTF-8"></meta><meta name="built-on" content="2024-08-08T15:14:17.47683562"><meta name="build-number" content="170"><title>Pattern | MPS Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"thepatternlanguage","level":0,"title":"The Pattern language","anchor":"#thepatternlanguage"},{"id":"patternexpression","level":0,"title":"PatternExpression","anchor":"#patternexpression"},{"id":"examples","level":0,"title":"Examples","anchor":"#examples"},{"id":"usingpatterns","level":0,"title":"Using patterns","anchor":"#usingpatterns"},{"id":"lightpatterns","level":0,"title":"Light patterns (pattern builders)ï»¿","anchor":"#lightpatterns"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/storage/help-app/v6/app.css" rel="stylesheet"><link rel="manifest" href="https://www.jetbrains.com/site.webmanifest"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Pattern | MPS"><meta property="og:description" content=""><meta property="og:image" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><meta property="og:site_name" content="MPS Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://www.jetbrains.com/help/mps/pattern.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@jetbrains_MPS"><meta name="twitter:title" content="Pattern | MPS"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@jetbrains_MPS"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "https://www.jetbrains.com/help/mps/pattern.html#webpage",
    "url": "https://www.jetbrains.com/help/mps/pattern.html",
    "name": "Pattern | MPS",
    "description": "",
    "image": "https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "https://www.jetbrains.com/help/mps/#website",
    "url": "https://www.jetbrains.com/help/mps/",
    "name": "MPS Help"
}</script><!-- End Schema.org --><script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
        var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&amp;l=' + l : '';
        j.async = true;
        j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-5P98');
</script>
<script src="https://resources.jetbrains.com/storage/help-app/v6/analytics.js"></script>
</head><body data-id="pattern" data-main-title="Pattern" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="mps-user-s-guide.topic|MPS User's Guide///platform-languages.topic|Platform-languages"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>MPS 2024.1 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="pattern" id="pattern.topic">Pattern</h1><section class="chapter"><h2 id="thepatternlanguage" data-toc="thepatternlanguage">The Pattern language</h2><p id="-3nqse_1">The pattern language has a single purpose - to define patterns of model structures. Those patterns form visual representations of nodes you want to match. A pattern matches a node if the node's property values are equal to those specified in the pattern, node's references point to the same targets that the ones of the pattern do and the corresponding children match the appropriate children of the pattern.</p><p id="-3nqse_2">Also patterns may contain variables for nodes, references and properties, which then match any node/reference/property. On top of that the variables will hold the actual values upon a successful match.</p></section><section class="chapter"><h2 id="patternexpression" data-toc="patternexpression">PatternExpression</h2><p id="-3nqse_3">The single most important concept of the pattern language is <em id="-3nqse_4">PatternExpression</em>. It contains a pattern as its single arbitrary node. Also, the node can specify the following variables:</p><ul class="list _bullet" id="-3nqse_5"><li class="list__item" id="-3nqse_6"><p>#name - a node variable, a placeholder for a node. Stores the matching node</p></li><li class="list__item" id="-3nqse_7"><p>#name - a reference variable, a placeholder for a reference. Stores the reference's target, i.e. a node.</p></li><li class="list__item" id="-3nqse_8"><p>$name - a property variable, a placeholder for a property value. Stores the property value, i.e. a string.</p></li><li class="list__item" id="-3nqse_9"><p>*name - a list variable, a placeholder for nodes in the same role. Stores the list of nodes.</p></li></ul><p id="-3nqse_10">Antiquotations may be in particular useful when used inside a pattern, just like inside quotations (refer to <a href="typesystem.html#antiquotations" id="-3nqse_11">Antiquotations</a>).</p></section><section class="chapter"><h2 id="examples" data-toc="examples">Examples</h2><p id="-3nqse_12"><b id="-3nqse_13">1.</b> The following pattern matches against any <em id="-3nqse_14">InstanceMethodDeclaration</em> without parameters and a return type:</p><figure id="-3nqse_15"><img alt="pattern0.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/pattern0.png" title="pattern0.png" width="226" height="74"></figure><p id="-3nqse_16">Captured variables:</p><div class="table-wrapper"><table class="no_header wide" id="-3nqse_17"><tbody><tr id="-3nqse_18"><td id="-3nqse_19"><p id="-3nqse_20">$methodName</p></td><td id="-3nqse_21"><p id="-3nqse_22"><em id="-3nqse_23">string</em></p></td><td id="-3nqse_24"><p id="-3nqse_25">method's name</p></td></tr><tr id="-3nqse_26"><td id="-3nqse_27"><p id="-3nqse_28">#statementList</p></td><td id="-3nqse_29"><p id="-3nqse_30"><em id="-3nqse_31">node&lt;StatementList&gt;</em></p></td><td id="-3nqse_32"><p id="-3nqse_33">statements</p></td></tr></tbody></table></div><p id="-3nqse_34"><b id="-3nqse_35">2.</b> The following pattern matches against a <em id="-3nqse_36">ClassifierType</em> with the actual classifier specified inside an antiquotation expression and with any quantity of any type parameters:</p><p> <img alt="pattern.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/pattern.png" class="inline-icon-" title="pattern.png" id="-3nqse_37" width="369" height="22"></p><p id="-3nqse_38">Captured variables:</p><div class="table-wrapper"><table class="no_header wide" id="-3nqse_39"><tbody><tr id="-3nqse_40"><td id="-3nqse_41"><p id="-3nqse_42">*l</p></td><td id="-3nqse_43"><p id="-3nqse_44"><em id="-3nqse_45">nlist&lt;Type&gt;</em></p></td><td id="-3nqse_46"><p id="-3nqse_47">class type's parameters</p></td></tr><tr id="-3nqse_48"><td id="-3nqse_49"><p id="-3nqse_50">#ignored</p></td><td id="-3nqse_51"><p id="-3nqse_52"><em id="-3nqse_53">node&lt;Type&gt;</em></p></td><td id="-3nqse_54"><p id="-3nqse_55">used as wildcard, its contents is ignored. Means that parameters are arbitrary</p></td></tr></tbody></table></div></section><section class="chapter"><h2 id="usingpatterns" data-toc="usingpatterns">Using patterns</h2><section class="chapter"><h3 id="matchstatement" data-toc="matchstatement">Match statement</h3><p id="-3nqse_56">Patterns are typically used as conditions in match statements. Pattern variables can be referenced from inside of the match statement.</p><aside class="prompt" data-type="tip" data-title="" id="-3nqse_57"><p>The <em id="-3nqse_58">jetbrains.mps.lang.typesystem</em> must be imported for the <b id="-3nqse_59">match</b> statement to be available.</p></aside><p id="-3nqse_60">For example:</p><figure id="-3nqse_61"><img alt="Pattern2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Pattern2.png" title="Pattern2.png" width="368" height="209"></figure><p id="-3nqse_62">This piece of code examines a node <em id="-3nqse_63">n</em> and checks whether it satisfies the first or the second condition. Then the statement in the corresponding (matching) block is executed. A pattern variable <em id="-3nqse_64">$name</em> is used in a first block to print out the name of a node. In our case the node holds a variable declaration.</p></section><section class="chapter"><h3 id="otherusages" data-toc="otherusages">Other usages</h3><p id="-3nqse_65">Patterns are also used in several other language constructs in MPS. They may appear:</p><ul class="list _bullet" id="-3nqse_66"><li class="list__item" id="-3nqse_67"><p>as conditions on applicable nodes of typesystem/replacement/subtyping/other rules of typesystem language (See <a href="typesystem.html#inferencerules" id="-3nqse_68">Inference rules</a>)</p></li><li class="list__item" id="-3nqse_69"><p>as supertype patterns in coerce statement and coerce expression (See <a href="using-typesystem.html#coerceexpression" id="-3nqse_70">Coerce</a>)</p></li><li class="list__item" id="-3nqse_71"><p>as conditions on node in generator rules</p></li><li class="list__item" id="-3nqse_72"><p>as pattern in <em id="-3nqse_73">TransformStatement</em>&nbsp;used to define language migrations (See <a href="migrations.html" id="-3nqse_74">Migrations</a>)</p></li></ul><p id="-3nqse_75">You can also use patterns in your own languages.</p><p id="-3nqse_76">Basically what&nbsp; happens is that a class is generated from a <em id="-3nqse_77">PatternExpression</em> and the expression itself is reduced to a constructor of this class. This class extends <em id="-3nqse_78">GeneratedMatcher</em> and has a boolean method <em id="-3nqse_79">match(SNode)</em>, which returns a boolean value indicating whether the node matches the pattern. It also holds a method <em id="-3nqse_80">getFieldValue(String)</em> to get the values stored in pattern variables after a successful match.</p><p id="-3nqse_81">To develop your own language constructs using patterns, you can call these two methods in the generator template for your constructs.</p></section></section><section class="chapter"><h2 id="lightpatterns" data-toc="lightpatterns">Light patterns (pattern builders)ï»¿</h2><p id="-3nqse_82">Pattern language, which allows the user to match code against a parametrized structure, is based on <a href="quotations.html" id="-3nqse_83">quotations</a> and has its counterpart based on <a href="quotations.html#lightquotations_quotationbuilders" id="-3nqse_84">light quotations</a>. Using light patterns helps to avoid problems like bootstrap dependency and confusing node editors. They have some additional advantages:</p><ul class="list _bullet" id="-3nqse_85"><li class="list__item" id="-3nqse_86"><p>Light patterns are better integrated into baseLanguage. Nodes can be matched against light patterns via the pattern switch statement. Light patterns can be written directly in place inside the switch clause or declared independently as class members and then used from the switch clause. </p><figure id="-3nqse_87"><img alt="lightpattern1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/lightpattern1.png" title="lightpattern1.png" width="700" height="369"></figure></li><li class="list__item" id="-3nqse_88"><p>Only those node properties and links should be mentioned that need to be checked during matching. If any value should match (wildcard behavior), the property or link can be omitted. </p><figure id="-3nqse_89"><img alt="lightpattern2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/lightpattern2.png" title="lightpattern2.png" width="500" height="232"></figure></li><li class="list__item" id="-3nqse_90"><p id="-3nqse_91">Pattern variables can be used inside the switch clauses to retrieve nodes and properties from the matched node. They can be used inside the pattern initializers as well, to create patterns matching self-referencing subtrees or duplicated property values. If there is no node to match with the variable, the variable may hold a <b id="-3nqse_92">null</b> value.</p><figure id="-3nqse_93"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/lightpattern3.png" class="lightbox"><img alt="lightpattern3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/lightpattern3.png" title="lightpattern3.png" width="700" height="351"></a></figure><aside class="prompt" data-type="tip" data-title="" id="-3nqse_94"><p>For collections of nodes the placement of the pattern variable results in the variable matching the whole collection or a node in that collection. </p><figure id="-3nqse_95"><img alt="lightpattern4.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/lightpattern4.png" title="lightpattern4.png" width="500" height="164"></figure><p> It the first case the variable will hold a <em id="-3nqse_96">sequence&lt;node&gt;</em>, in the second case the variable will hold a <em id="-3nqse_97">node</em> and is guaranteed not to be null.</p></aside></li><li class="list__item" id="-3nqse_98"><p>If a list of nodes is defined in a light pattern then the order defined in the list is strictly followed during matching. While this is desired for ordered child collections, which is the default in MPS, it may give surprising results when matching against unordered collections, since the light pattern language always considers the order in its definition. An explanatory info message is shown to the user to indicate situations when matching against an unordered collection is detected. </p><figure id="-3nqse_99"><img alt="lightpattern5.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/lightpattern5.png" title="lightpattern5.png" width="500" height="333"></figure></li></ul></section><div class="last-modified">Last modified: 11 February 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="using-model-module-dependencies-faq.html" class="navigation-links__prev">Using model &amp; module dependencies FAQ</a><a href="build-language.html" class="navigation-links__next">Build Language</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/storage/help-app/v6/app.js"></script></body></html>
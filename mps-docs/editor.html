<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><link rel="canonical" href="https://www.jetbrains.com/help/mps/editor.html" data-react-helmet="true"/><meta charset="UTF-8"></meta><meta name="built-on" content="2024-08-08T15:14:20.885839148"><meta name="build-number" content="170"><title>Editor | MPS Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"editoroverview","level":0,"title":"Editor Overview","anchor":"#editoroverview"},{"id":"typesofcellmodels","level":0,"title":"Types Of Cell Models","anchor":"#typesofcellmodels"},{"id":"celllayouts","level":0,"title":"Cell layouts","anchor":"#celllayouts"},{"id":"styles","level":0,"title":"Styles","anchor":"#styles"},{"id":"styleproperties","level":0,"title":"Style properties","anchor":"#styleproperties"},{"id":"cellactions","level":0,"title":"Cell actions","anchor":"#cellactions"},{"id":"cellmenus","level":0,"title":"Cell menus","anchor":"#cellmenus"},{"id":"customizingreferencepresentation","level":0,"title":"Customizing reference presentation","anchor":"#customizingreferencepresentation"},{"id":"migrationofpresentationqueryinreferenceconstraints","level":0,"title":"Migration of presentation query in reference constraints","anchor":"#migrationofpresentationqueryinreferenceconstraints"},{"id":"two-stepdeletion","level":0,"title":"Two-step deletion","anchor":"#two-stepdeletion"},{"id":"selecting_editor_cells","level":0,"title":"Selecting editor cells","anchor":"#selecting_editor_cells"},{"id":"-nwwk6s_4","level":0,"title":"Custom style and priority of completion items (EXPERIMENTAL)","anchor":"#-nwwk6s_4"}]</script><script type="application/json" id="topic-shortcuts">{"$SelectAll":{"Windows":{"keystrokes":[{"keys":["mod-Control","char-A"]}],"platform":"PC"},"Emacs":{"keystrokes":[{"keys":["mod-Control","char-X"]},{"keys":["char-H"]}],"platform":"PC"},"GNOME":{"keystrokes":[{"keys":["mod-Control","char-A"]}],"platform":"PC"},"KDE":{"keystrokes":[{"keys":["mod-Control","char-A"]}],"platform":"PC"},"Sublime Text":{"keystrokes":[{"keys":["mod-Control","char-A"]}],"platform":"PC"},"XWin":{"keystrokes":[{"keys":["mod-Control","char-A"]}],"platform":"PC"},"macOS":{"keystrokes":[{"keys":["mod-Command","char-A"]}],"platform":"MAC"},"Sublime Text (macOS)":{"keystrokes":[{"keys":["mod-Command","char-A"]}],"platform":"MAC"}}}</script><link href="https://resources.jetbrains.com/storage/help-app/v6/app.css" rel="stylesheet"><link rel="manifest" href="https://www.jetbrains.com/site.webmanifest"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Editor | MPS"><meta property="og:description" content=""><meta property="og:image" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><meta property="og:site_name" content="MPS Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://www.jetbrains.com/help/mps/editor.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@jetbrains_MPS"><meta name="twitter:title" content="Editor | MPS"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@jetbrains_MPS"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "https://www.jetbrains.com/help/mps/editor.html#webpage",
    "url": "https://www.jetbrains.com/help/mps/editor.html",
    "name": "Editor | MPS",
    "description": "",
    "image": "https://resources.jetbrains.com/storage/products/mps/img/meta/preview.png",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "https://www.jetbrains.com/help/mps/#website",
    "url": "https://www.jetbrains.com/help/mps/",
    "name": "MPS Help"
}</script><!-- End Schema.org --><script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
        var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&amp;l=' + l : '';
        j.async = true;
        j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-5P98');
</script>
<script src="https://resources.jetbrains.com/storage/help-app/v6/analytics.js"></script>
</head><body data-id="editor" data-main-title="Editor" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="mps-user-s-guide.topic|MPS User's Guide///language-definition.topic|Language-definition"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>MPS 2024.1 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="editor" id="editor.topic">Editor</h1><p id="-nwwk6s_8">Once the structure for your language is defined, you will probably go and create the means to allow developers to conveniently build ASTs with it. Manipulating the ASTs directly is not very intuitive nor productive. To hide the AST and offer the user comfortable and intuitive interaction is the role for language editors.</p><aside class="prompt" data-type="tip" data-title="" id="-nwwk6s_9"><p id="-nwwk6s_10">There are sometimes situations when manipulating the AST directly is necessary. For example, when the available editor definition does not give you access to all the properties of a node. The <b id="-nwwk6s_11">reflective editor</b> gives you the power to cease the editor for a selected node and instead access the AST directly. Hit <b id="-nwwk6s_12">F5</b> to revert back to the default editor.</p><figure id="-nwwk6s_13"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/ReflectiveEditorFix1.png" class="lightbox"><img alt="ReflectiveEditorFix1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/ReflectiveEditorFix1.png" title="ReflectiveEditorFix1.png" width="300" height="368"></a></figure></aside><section class="chapter"><h2 id="editoroverview" data-toc="editoroverview">Editor Overview</h2><p id="-nwwk6s_14">An editor for a node serves as its view as well as its controller. An editor displays the node and lets the user modify, replace, delete it and so on. Nodes of different concepts have different editors. A language designer should create an editor for every concept in his/her language.</p><p id="-nwwk6s_15">In MPS, an editor consists of cells, which themselves contain other cells, some text, or a UI component. Each editor has its concept for which it is specified. A concept may have no more than one editor declaration (or can have none). If a concept does not have an editor declaration, its instances will be edited with an editor for the concept's nearest ancestor that has an editor declaration.</p><p id="-nwwk6s_16">To describe an editor for a certain concept (i.e. which cells have to appear in an editor for nodes of this concept), a language designer will use a dedicated language simply called <em id="-nwwk6s_17">editor language</em>. You see, MPS applies the <em id="-nwwk6s_18">Language Oriented Programming</em> principles to itself.</p><p id="-nwwk6s_19">The description of an editor consists of descriptions for cells it holds. We call such descriptions "cell models." For instance, if you want your editor to consist of a unique cell with unmodifiable text, you create in your editor description a constant cell model and specify that text. If you want your editor to consist of several cells, you create a collection cell model and then, inside it, you specify cell models for its elements. And so on.</p><aside class="prompt" data-type="tip" data-title="" id="-nwwk6s_20"><p id="-nwwk6s_21">For a quick how-to document on the MPS editor please check out the <a href="editor-cookbook.html" id="-nwwk6s_22">Editor Cookbook</a>.</p></aside><section class="chapter"><h3 id="concepteditordefinition" data-toc="concepteditordefinition">Concept Editor definition</h3><p id="-nwwk6s_23">A definition of an editor for a concept contains two sections:</p><ul class="list _bullet" id="-nwwk6s_24"><li class="list__item" id="-nwwk6s_25"><p><b id="-nwwk6s_26">node cell layout</b> - holds the actual (main) editor definition for the concept</p></li><li class="list__item" id="-nwwk6s_27"><p><b id="-nwwk6s_28">inspected cell layout</b> - holds a secondary definition that is shown in the <a href="mps-inspector.html" id="-nwwk6s_29">Inspector</a> tool window when the user puts the cursor on this node's editor in the main window. Typically, the <b id="-nwwk6s_30">Inspector</b> part of the editor is used to provide less-important or less frequently read/modified properties of the concept.</p></li></ul></section><section class="chapter"><h3 id="-nwwk6s_1" data-toc="-nwwk6s_1">Fallback to reflective editor in case of problems</h3><p id="-nwwk6s_31">When the editor definition fails to initialize due to an exception at run-time, the default reflective editor is shown for the corresponding cell. A descriptive error is displayed in the Messages tool window allowing the user to get a complete stacktrace as well as to navigate to the problem cell.</p><figure id="-nwwk6s_32"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/EditorError.png" class="lightbox"><img alt="EditorError.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/EditorError.png" title="EditorError.png" width="650" height="356"></a></figure></section><section class="chapter"><h3 id="-nwwk6s_2" data-toc="-nwwk6s_2">Type over existing text</h3><p id="-nwwk6s_33">Type over existing text further blurs the distinction between textual and projectional editors. When typing into a textual cell, and the character you just typed is already present at the caret position, then the caret will move right as if you just overwrote the existing character on screen. This feature is only triggered if the keystroke cannot be gracefully processed and is otherwise ignored (e.g. in constant cells) or makes the cell content invalid. The feature if ON by default and can turned OFF in <em id="-nwwk6s_34">Settings / Editor / MPS Editor</em> tab.</p></section><section class="chapter"><h3 id="-nwwk6s_3" data-toc="-nwwk6s_3">Sync with model on selection change</h3><p id="-nwwk6s_35">When the user inserts a value that violates a constraint (a property value or a reference) into a cell, that cell becomes red. Despite the editor showing an errorneous value (in red), the model still contains the previous valid value. A configurable option allows the user to specify whether the original valid value is restored in the editor after moving the cursor or focus away from the errorneous cell. The feature if OFF by default and can turned ON in <em id="-nwwk6s_36">Settings / Editor / MPS Editor</em> tab.</p></section></section><section class="chapter"><h2 id="typesofcellmodels" data-toc="typesofcellmodels">Types Of Cell Models</h2><div class="table-wrapper"><table class="wide" id="-nwwk6s_37"><thead><tr class="ijRowHead" id="-nwwk6s_38"><th id="-nwwk6s_39"><section class="chapter"><h3 id="constant&nbsp;cell" data-toc="constant&nbsp;cell">Constant&nbsp;cell</h3></section></th><th id="-nwwk6s_40"><p><img alt="ConstantCell.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/ConstantCell.png" class="inline-icon-" title="ConstantCell.png" id="-nwwk6s_41" width="79" height="18"></p><p id="-nwwk6s_42">This model describes a cell which will always contain the same text. Constant cells typically mirror "keywords" in text-based progamming languages.</p></th></tr></thead><tbody><tr id="-nwwk6s_43"><td id="-nwwk6s_44"><section class="chapter"><h3 id="collectioncell" data-toc="collectioncell">Collection cell</h3></section></td><td id="-nwwk6s_45"><p id="-nwwk6s_46">A cell which contains other cells. Can be horizontal</p><p> <img alt="HorizontalCollection.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/HorizontalCollection.png" class="inline-icon-" title="HorizontalCollection.png" id="-nwwk6s_47" width="106" height="18"></p><p id="-nwwk6s_48">(cells in a collection are arranged in a row), vertical</p><figure id="-nwwk6s_49"><img alt="VerticalCollection.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/VerticalCollection.png" title="VerticalCollection.png" width="86" height="48"></figure><p id="-nwwk6s_50">(cells are on top of each other) or have so-called "indent layout"</p><p> <img alt="IndentCollection.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/IndentCollection.png" class="inline-icon-" title="IndentCollection.png" id="-nwwk6s_51" width="112" height="18"></p><p id="-nwwk6s_52">(cells are arranged horizontally but if a line is too long it is wrapped like text to the next line, with indent before each next line).</p><p id="-nwwk6s_53">In Inspector, you can specify whether the resulting cell collection will use folding or not, and whether it will use braces or not. Folding allows your cell list to contract into a single cell (fold) and to expand from it (unfold) when necessary. It is useful for a programmer writing in your language when editing a large root: he/she is able to fold some cells and hide all the information that is not necessary for the current task. For instance, when editing a large class, one can fold all method bodies except the method he/she is editing at the moment.</p><p id="-nwwk6s_54">The <b id="-nwwk6s_55">collapse by default</b> property when set to true will ensure, that the collection shows up folded when displayed for the first time, unless the user unfolds it manually.</p><p id="-nwwk6s_56">Collection cells can also specify a <b id="-nwwk6s_57">Context assistant</b>, which will provide intuitive visual actions to the user. For more information, refer to <a href="context-assistant.html" id="-nwwk6s_58">Context assistant documentation</a>.</p></td></tr><tr id="-nwwk6s_59"><td id="-nwwk6s_60"><section class="chapter"><h3 id="propertycell" data-toc="propertycell">Property cell</h3></section></td><td id="-nwwk6s_61"><p><img alt="PropertyCell.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/PropertyCell.png" class="inline-icon-" title="PropertyCell.png" id="-nwwk6s_62" width="91" height="18"></p><p id="-nwwk6s_63">This cell model describes a cell which will show a value of a certain property of a node. The value of a property can be edited in a property cell, therefore, a property cell serves not only as a view also but as a controller. In an inspector, you can specify whether the property cell will be read-only or will allow its property value to be edited.</p></td></tr><tr id="-nwwk6s_64"><td id="-nwwk6s_65"><section class="chapter"><h3 id="childcell" data-toc="childcell">Child cell</h3></section></td><td id="-nwwk6s_66"><p><img alt="ChildCell.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/ChildCell.png" class="inline-icon-" title="ChildCell.png" id="-nwwk6s_67" width="70" height="18"></p><p id="-nwwk6s_68">This cell model contains a reference to a certain link declaration in a node's concept. The resulting cell will contain an editor for the link's target (almost always for the child, not the referent). For example if you have a binary operation, say " + ", with two children, "leftOperand" and "rightOperand", an editor model for your operation will be the following: a indent collection cell containing a referenced node cell for the left operand, a constant cell with " + ", and a referenced node cell for the right operand. It will be rendered as an editor for the right operand, then a cell with " + ", and then an editor for the left operand, arranged in a row. As we have seen, and as follows from its name, this type of cell model is typically used to show editors for children.</p></td></tr><tr id="-nwwk6s_69"><td id="-nwwk6s_70"><section class="chapter"><h3 id="referentcell" data-toc="referentcell">Referent cell</h3></section></td><td id="-nwwk6s_71"><p><img alt="ReferenceCell.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/ReferenceCell.png" class="inline-icon-" title="ReferenceCell.png" id="-nwwk6s_72" width="204" height="18"></p><p id="-nwwk6s_73">Used mainly to show reference targets. The main difference between a referent cell and a child cell is that we don't need, or don't want, to show the whole editor for a reference target. For example, when a certain node, say, a class type, has a reference to a java class, we don't want to show the whole editor for that class with its methods, fields, and so on; we just want to show its name. Therefore child cells cannot be used for such a purpose. One should use referent cells.</p><p id="-nwwk6s_74">Referent cell allows you to show a different inlined editor for a reference target, instead of using target's own editor. In most cases it's very simple: a cell for a reference target usually consists only of a property cell with the target's name.</p></td></tr><tr id="-nwwk6s_75"><td id="-nwwk6s_76"><section class="chapter"><h3 id="childlistcell" data-toc="childlistcell">Child list cell</h3></section></td><td id="-nwwk6s_77"><p><img alt="ChildListCell.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/ChildListCell.png" class="inline-icon-" title="ChildListCell.png" id="-nwwk6s_78" width="269" height="18"></p><p id="-nwwk6s_79">This cell is a collection containing multiple child cells for a node's children of the same role. For instance, an editor for a method call will contain a child list cell for rendering its actual arguments. Child list can be indent (text like), horizontal or vertical.</p><p id="-nwwk6s_80">The cell generated from this cell model supports insertion and deletion of the children of the role given, thus serving both as a view and as a controller. The default keys for insertion are Insert and Enter (to insert a child before or after the selected one, respectively), and the default key for deletion is Delete.</p><p id="-nwwk6s_81">You also can specify a separator for your list. A separator is a character which will be shown in constant cells between cells for the children. When you are inside the cell list and you press a key with this character, a new child will be inserted after the selected child. For instance, a separator for a list representing actual parameters in a method call is a comma. The query that defines the separator can react to the position of the node in the collection and thus the separator in a single child collection can be different in different positions.</p><p id="-nwwk6s_82">In Inspector, you can specify whether the resulting cell list will use folding or not, and whether it will use braces or not. Folding allows your cell list to contract into a single cell (fold) and to expand from it (unfold) when necessary. It is useful for a programmer writing in your language when editing a large root: he/she is able to fold some cells and hide all the information in editor that is not necessary for the current task at the moment. For instance, when editing a large class, one can fold all method bodies except the method he/she is editing at the moment.</p></td></tr><tr id="-nwwk6s_83"><td id="-nwwk6s_84"><section class="chapter"><h3 id="indentcell" data-toc="indentcell">Indent cell</h3></section></td><td id="-nwwk6s_85"><p id="-nwwk6s_86"><img alt="IndentCell.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/IndentCell.png" class="inline-icon-" title="IndentCell.png" id="-nwwk6s_87" width="31" height="18"> An indent cell model will be generated into a non-selectable constant cell containing a whitespace. The main difference between a cell generated from an indent cell and one generated from a constant cell model containing whitespaces as its text is that the width of an indent cell will vary according to user-defined global editor settings. For instance, if a user defines an indent to be 4 spaces long, then every indent cell will occupy a space of 4 characters; if 2 spaces long, then every indent cell will be 2 characters.</p></td></tr><tr id="-nwwk6s_88"><td id="-nwwk6s_89"><section class="chapter"><h3 id="uicomponentcell" data-toc="uicomponentcell">UI component cell</h3></section></td><td id="-nwwk6s_90"><p><img alt="ComponentCell.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/ComponentCell.png" class="inline-icon-" title="ComponentCell.png" id="-nwwk6s_91" width="140" height="18"></p><p id="-nwwk6s_92">This cell model allows a language designer to insert an arbitrary UI component inside an editor for a node. A language designer should write a function that returns a JComponent, and that component will be inserted into the generated cell. Note that such a component will be re-created every time an editor is rebuilt, so don't try to keep any state inside your component. Every state should be taken from and written into a model (i.e. node, its properties and references) - not a view (your component).</p><p id="-nwwk6s_93">A good use case for such a cell model is when you keep a path to some file in a property, and your component is a button which activates a modal file chooser. The default selected path in a file chooser is read from the above-mentioned property, and the file path chosen by the user is written to that property.</p></td></tr><tr id="-nwwk6s_94"><td id="-nwwk6s_95"><section class="chapter"><h3 id="modelaccess" data-toc="modelaccess">Model access</h3></section></td><td id="-nwwk6s_96"><p><img alt="ModelAcces.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/ModelAcces.png" class="inline-icon-" title="ModelAcces.png" id="-nwwk6s_97" width="119" height="18"></p><p id="-nwwk6s_98">A model access cell model is a generalization of a property cell and, therefore, is more flexible. While a property cell simply shows the value of a property and allows the user to change that value, a model access cell may show an arbitrary text based on the node's state and modify the node in an arbitrary way based on what changes the user has made to the cell's text.</p><p id="-nwwk6s_99">While making a property cell work requires you only to specify a property to access via that cell, making a model access cell work requires a language designer to write three methods: "get," "set," and "validate." The latter two are somewhat optional.</p><p id="-nwwk6s_100">A "get" method takes a node and should return a String, which will be shown as the cell's text. A "set" method takes a String - the cell's text - and should modify a node according to this String, if necessary. A "validate" method takes the cell's text and returns whether it is valid or not. If a text in a cell becomes invalid after a user change, then it is marked red and is not passed to the "set" method.</p><p id="-nwwk6s_101">If a "validate" method is not specified, a cell will always be valid. If a "set" method is not specified, no changes in a cell's text will affect its node itself.</p></td></tr><tr id="-nwwk6s_102"><td id="-nwwk6s_103"><section class="chapter"><h3 id="nextapplicableeditor" data-toc="nextapplicableeditor">Next applicable editor</h3></section></td><td id="-nwwk6s_104"><p id="-nwwk6s_105">A more specific editor may reuse a less specific editor of the same concept through the new <b id="-nwwk6s_106">next applicable editor</b> editor cell. The <b id="-nwwk6s_107">next applicable editor</b> cell is used as a place holder, which will re-apply the logic for finding the less specific editor and insert the found editor in its place. For example, an editor specific to a particular <b id="-nwwk6s_108">context hint</b> may provide some visual ceremony around a <b id="-nwwk6s_109">next applicable editor</b> cell. By removing the <b id="-nwwk6s_110">context hint</b> on the <b id="-nwwk6s_111">next applicable editor</b> cell, MPS will reevaluate the editor-discovery logic and supply the found editor into the <b id="-nwwk6s_112">next applicable editor</b> cell.</p><figure id="-nwwk6s_113"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/next1.png" class="lightbox"><img alt="next1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/next1.png" title="next1.png" width="100" height="57"></a></figure><p id="-nwwk6s_114">In particular this mechanism is frequently being used to implement editors for "commented out" nodes when customizing the generic <b id="-nwwk6s_115">comment out</b> functionality.</p></td></tr><tr id="-nwwk6s_116"><td id="-nwwk6s_117"><section class="chapter"><h3 id="tooltipcell" data-toc="tooltipcell">Tooltip</h3></section></td><td id="-nwwk6s_118"><p id="-nwwk6s_119">Allows a helpful message to be displayed in a little tooltip popup window when the user hovers over a part of the editor. The <em id="-nwwk6s_120">tooltips</em> language must be imported into the editor model. The users may utilize a "tooltip radar" that visualizes all cells with a tooltip - just press and hold the <em id="-nwwk6s_121">Control</em> key and then move the mouse. The language was adopted into MPS from the mbeddr project.</p><figure id="-nwwk6s_122"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/editorTooltip1.png" class="lightbox"><img alt="editorTooltip1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/editorTooltip1.png" title="editorTooltip1.png" width="100" height="16"></a></figure></td></tr><tr id="-nwwk6s_123"><td id="-nwwk6s_124"><section class="chapter"><h3 id="imagecell" data-toc="imagecell">Image cell</h3></section></td><td id="-nwwk6s_125"><p><img alt="ImageCell.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/ImageCell.png" class="inline-icon-" title="ImageCell.png" id="-nwwk6s_126" width="73" height="24"></p><p id="-nwwk6s_127">Enables an image to be included in the editor. The image file can be either selected directly or pointed to with an absolute path string or a path relative to the module's root.</p></td></tr><tr id="-nwwk6s_128"><td id="-nwwk6s_129"><section class="chapter"><h3 id="customcell" data-toc="customcell">Custom cell</h3></section></td><td id="-nwwk6s_130"><p><img alt="CustomCell.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/CustomCell.png" class="inline-icon-" title="CustomCell.png" id="-nwwk6s_131" width="112" height="18"></p><p id="-nwwk6s_132">If other cell models are not enough for a language designer to create the editor he/she wants, there's one more option left for him/her: to create a cell provider which will return an arbitrary custom cell. The only restriction is that it should implement an "EditorCell" interface.</p></td></tr></tbody></table></div><section class="chapter"><h3 id="editorcomponentsandeditorcomponentcells" data-toc="editorcomponentsandeditorcomponentcells">Editor Components and editor component cells</h3><p id="-nwwk6s_133">Sometimes two or more editor declarations for different concepts have a common part, which is duplicated in each of those editors. To avoid redundancy, there's a mechanism called editor components. You specify a concept for which an editor component is created and create a cell model, just as in concept editor declaration. When written, the component could then be used in editor declarations for any of the specified concept's descendants. To use an editor component inside your editor declarations, one will create a specific cell model: editor component cell model, and set your editor component declaration as the target of this cell model's reference.</p></section></section><section class="chapter"><h2 id="celllayouts" data-toc="celllayouts">Cell layouts</h2><p id="-nwwk6s_134">Each collection cell has property "cell layout", which describes how child nodes will be placed. There are several layouts:</p><ul class="list _bullet" id="-nwwk6s_135"><li class="list__item" id="-nwwk6s_136"><p>indent layout - places cells like text.</p></li><li class="list__item" id="-nwwk6s_137"><p>horizontal layout - places cells horizontally in row.</p></li><li class="list__item" id="-nwwk6s_138"><p>vertical layout - places cells vertically.</p></li><li class="list__item" id="-nwwk6s_139"><p>super-/subscript layout â places cells superscript or subscript w.r.t. the baseline.</p></li><li class="list__item" id="-nwwk6s_140"><p>flow layout - places cells horizontally in row without gaps between the cells. Cells exceeding the right margin will be placed on the next line.</p></li><li class="list__item" id="-nwwk6s_141"><p>table layout - places cells into a tabular shape.</p></li><li class="list__item" id="-nwwk6s_142"><p>vertical grid layout - places cells vertically, while allowing the nested horizontal layouts cooperate to align cels into a grid.</p></li></ul><p id="-nwwk6s_143">The <b id="-nwwk6s_144">indent layout</b> cell offers several properties to customize the layout, some are applicable to the layout cell itself, some to the cells inside the layout cell:</p><ul class="list _bullet" id="-nwwk6s_145"><li class="list__item" id="-nwwk6s_146"><p>indent-layout-indent - this cell will have an&nbsp;<em id="-nwwk6s_147">indent</em> prepended, if displayed as first on a line</p></li><li class="list__item" id="-nwwk6s_148"><p>indent-layout-new-line - this cell will be the last on a line</p></li><li class="list__item" id="-nwwk6s_149"><p>indent-layout-on-new-line - this cell will be first on the next line</p></li><li class="list__item" id="-nwwk6s_150"><p>indent-layout-new-line-children - all children cells of this collection cell will be displayed on separate lines</p></li><li class="list__item" id="-nwwk6s_151"><p>indent-layout-wrap-anchor - when the children cells of this collection cell exceed the width of the screen, they will be wrapped to vertically align with this collection</p></li><li class="list__item" id="-nwwk6s_152"><p>indent-layout-indent-anchor - all subsequent indents will be calculated relative to the indentation of the current collection cell</p></li><li class="list__item" id="-nwwk6s_153"><p>indent-layout-no-wrap - The cell must never be wrapped so that it ends up first on a new line</p></li></ul><p id="-nwwk6s_154">The <b id="-nwwk6s_155">super-/subscript layout</b> cell enables the possibility to set inner cells slightly above/below the baseline, respectively. To trigger the inner cell styling, add the corresponding <b id="-nwwk6s_156">script-kind</b> style to the child cell. For example:</p><figure id="-nwwk6s_157"><img alt="example-scriptkind.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/example-scriptkind.png" title="example-scriptkind.png" width="400" height="172"></figure><p id="-nwwk6s_158">The <b id="-nwwk6s_159">flow layout</b> cell does not provide any gaps between the cells, so consider using the <em id="-nwwk6s_160">paddiing-left/right</em> property on the individual cells.</p><p id="-nwwk6s_161">Inside the <b id="-nwwk6s_162">table layout</b> use the <em id="-nwwk6s_163">table-component</em> property to indicate whether the nested cells should be handled as a vertical (column) or a horizontal (row) collection of the table.</p></section><section class="chapter"><h2 id="styles" data-toc="styles">Styles</h2><p id="-nwwk6s_164">Styling the editor cells gives language designers a very powerful way to improve readability of the code. Having keywords, constants, calls, definitions, expressions, comments and other language elements displayed each in different colors or fonts helps developers grasp the syntax more easily. You can also use styling to mask areas of the editor as read-only, so that developers cannot edit them.</p><p id="-nwwk6s_165">Each cell model has some appearance settings that determine the cell's presentation. They are, for instance, <em id="-nwwk6s_166">font color</em>, <em id="-nwwk6s_167">font style</em>, whether a cell is <em id="-nwwk6s_168">selectable</em>, and some others. Those settings are combined into an entity called <em id="-nwwk6s_169">stylesheet</em>. A <b id="-nwwk6s_170">stylesheet</b> could be either <b id="-nwwk6s_171">inline</b>, i.e. be described together with a particular cell model, or it could be <b id="-nwwk6s_172">declared separately</b> and used in many cell models. Both <b id="-nwwk6s_173">inline stylesheet</b>&nbsp;and <b id="-nwwk6s_174">style reference</b>&nbsp;are specified for each cell in its <em id="-nwwk6s_175">Inspector View</em>.</p><figure id="-nwwk6s_176"><img alt="style2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/style2.png" title="style2.png" width="404" height="287"></figure><figure id="-nwwk6s_177"><img alt="style1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/style1.png" title="style1.png" width="394" height="250"></figure><p id="-nwwk6s_178">The settings do not have to be specified by a single value. A&nbsp;<b id="-nwwk6s_179">query</b> option is also available for all settings, in which case a concept function needs to be implemented by the developer, which returns the desired value:</p><figure id="-nwwk6s_180"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/image2017-10-19-18-2-53.png" class="lightbox"><img alt="image2017-10-19-18-2-53.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/image2017-10-19-18-2-53.png" title="image2017-10-19-18-2-53.png" width="500" height="156"></a></figure><p id="-nwwk6s_181">It is a good practice to declare a few stylesheets for different purposes. Another good practice is to have a style guideline in mind when developing an editor for your language, as well as when developing extensions for your language. For example, in <em id="-nwwk6s_182">BaseLanguage</em> there are styles for keywords (applied to those constant cells in the <em id="-nwwk6s_183">BaseLanguage</em> editor, which correspond to keywords in Java), static fields (applied to static field declarations and static field references), instance fields, numeric literals, string literals, and so forth. When developing an extension to <em id="-nwwk6s_184">BaseLanguage</em>, you should apply keyword style to new keywords, field style to new types of fields, and so forth.</p><p id="-nwwk6s_185">A <b id="-nwwk6s_186">stylesheet</b> is quite similar to CSS stylesheets; it consists of a list of style classes, in which the values for some style properties are specified.&nbsp;MPS additionally provides a mechanism for extending styles as well as for property value overriding.</p></section><section class="chapter"><h2 id="styleproperties" data-toc="styleproperties">Style properties</h2><section class="chapter"><h3 id="booleanstyleproperties" data-toc="booleanstyleproperties">Boolean style properties</h3><ul class="list _bullet" id="-nwwk6s_187"><li class="list__item" id="-nwwk6s_188"><p><em id="-nwwk6s_189">selectable</em> - whether the cell can be selected. True by default.</p></li><li class="list__item" id="-nwwk6s_190"><p><em id="-nwwk6s_191">read-only</em>-&nbsp;whether one can modify the cell and the nested cells or not. <em id="-nwwk6s_192">False</em> by default. Designed for freezing fragments of cell tree.</p></li><li class="list__item" id="-nwwk6s_193"><p><em id="-nwwk6s_194">editable</em> - whether one can modify text in a cell or not. By default is <em id="-nwwk6s_195">false</em> for constant cell models, true for other cell models.</p></li><li class="list__item" id="-nwwk6s_196"><p><em id="-nwwk6s_197">draw-border</em> - whether border will be drawn around a cell</p></li><li class="list__item" id="-nwwk6s_198"><p><em id="-nwwk6s_199">draw-brackets</em> - whether brackets will be drawn around a cell</p></li><li class="list__item" id="-nwwk6s_200"><p><em id="-nwwk6s_201">first-position-allowed</em> /&nbsp;<em id="-nwwk6s_202">last-position-allowed</em> - for text-containing cells, specifies whether it is allowed that a caret is on the first/last position (i.e. before/after the whole text of a cell)</p></li></ul><p id="-nwwk6s_203">You can either choose a property value from a completion menu or specify a query i.e. a function which returns a boolean value.</p><figure id="-nwwk6s_204"><img alt="Style3.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Style3.png" title="Style3.png" width="624" height="167"></figure></section><section class="chapter"><h3 id="paddingproperties." data-toc="paddingproperties.">Padding properties.</h3><ul class="list _bullet" id="-nwwk6s_205"><li class="list__item" id="-nwwk6s_206"><p><em id="-nwwk6s_207">padding-left/right/top/bottom</em>&nbsp;- a floating point number, which specifies the padding of a text cell, i.e. how much space will be between cell's text and cell's left and right sides, respectively.</p></li></ul></section><section class="chapter"><h3 id="punctuationproperties." data-toc="punctuationproperties.">Punctuation properties.</h3><p id="-nwwk6s_208">All cells in a collection are separated with one space by default. Sometimes we need cells placed together.</p><ul class="list _bullet" id="-nwwk6s_209"><li class="list__item" id="-nwwk6s_210"><p><em id="-nwwk6s_211">punctuation-left</em> - if this property is true, space from left side of the cell is deleted and first position in cell becomes not allowed.</p></li><li class="list__item" id="-nwwk6s_212"><p><em id="-nwwk6s_213">punctuation-right</em> - if this property is true, space from right side of the cell is deleted and last position in cell becomes not allowed.</p></li><li class="list__item" id="-nwwk6s_214"><p><em id="-nwwk6s_215">horizontal-gap</em> - specifies gap size between cells in collection. Default value is 1 space.</p></li></ul><p id="-nwwk6s_216">For example in code</p><div class="code-block" data-lang="none">(1 + 1)
</div><p id="-nwwk6s_218">we don't want spaces between "(" and "1", and between "1" and ")". So we should add property punctuation-right to the cell "(", and property punctuation-left to the cell ")".</p></section><section class="chapter"><h3 id="colorstyleproperties" data-toc="colorstyleproperties">Color style properties</h3><ul class="list _bullet" id="-nwwk6s_219"><li class="list__item" id="-nwwk6s_220"><p>Text foreground color - cell text's color (affect text cells only)</p></li><li class="list__item" id="-nwwk6s_221"><p>Text background color - cell text's background color (affects text cells only)</p></li><li class="list__item" id="-nwwk6s_222"><p>Background color - the background color of a cell. Affects any cell. If a text cell has non-zero padding and some text background color, the cell's background color will be the color of its margins. You can either choose a color from the completion menu or specify a query i.e. a function which returns a color.</p></li></ul></section><section class="chapter"><h3 id="indentlayoutproperties" data-toc="indentlayoutproperties">Indent layout properties</h3><ul class="list _bullet" id="-nwwk6s_223"><li class="list__item" id="-nwwk6s_224"><p><em id="-nwwk6s_225">indent-layout-indent</em>&nbsp;- all lines will be placed with indent. This property can be used for indent in code block.</p></li></ul><figure id="-nwwk6s_226"><img alt="BlockStatementEditor.PNG" src="https://resources.jetbrains.com/help/img/idea/2024.1/BlockStatementEditor.PNG" title="BlockStatementEditor.PNG" width="630" height="358"></figure><ul class="list _bullet" id="-nwwk6s_227"><li class="list__item" id="-nwwk6s_228"><p><em id="-nwwk6s_229">indent-layout-new-line</em> - after this cell there will be a new line marker.</p></li></ul><figure id="-nwwk6s_230"><img alt="SwitchCaseEditor.PNG" src="https://resources.jetbrains.com/help/img/idea/2024.1/SwitchCaseEditor.PNG" title="SwitchCaseEditor.PNG" width="337" height="326"></figure><ul class="list _bullet" id="-nwwk6s_231"><li class="list__item" id="-nwwk6s_232"><p><em id="-nwwk6s_233">indent-layout-on-new-line</em> - this cell will be placed on a new line</p></li></ul><ul class="list _bullet" id="-nwwk6s_234"><li class="list__item" id="-nwwk6s_235"><p><em id="-nwwk6s_236">indent-layout-new-line-children</em>&nbsp;- all children of collection will be placed on new line</p></li></ul><figure id="-nwwk6s_237"><img alt="StatementListEditor.PNG" src="https://resources.jetbrains.com/help/img/idea/2024.1/StatementListEditor.PNG" title="StatementListEditor.PNG" width="706" height="324"></figure><ul class="list _bullet" id="-nwwk6s_238"><li class="list__item" id="-nwwk6s_239"><p><em id="-nwwk6s_240">indent-layout-no-wrap</em> - the line won't be wrapped before this cell</p></li></ul></section><section class="chapter"><h3 id="otherstyleproperties" data-toc="otherstyleproperties">Other style properties</h3><ul class="list _bullet" id="-nwwk6s_241"><li class="list__item" id="-nwwk6s_242"><p><em id="-nwwk6s_243">font family</em></p></li><li class="list__item" id="-nwwk6s_244"><p><em id="-nwwk6s_245">font size</em></p></li><li class="list__item" id="-nwwk6s_246"><p><em id="-nwwk6s_247">font style</em> - can be either plain, bold, italic, or bold italic.</p></li><li class="list__item" id="-nwwk6s_248"><p><em id="-nwwk6s_249">layout constraint</em>-&nbsp;</p><ul class="list _bullet" id="-nwwk6s_250"><li class="list__item" id="-nwwk6s_251"><p>For flow layout</p><ul class="list _bullet" id="-nwwk6s_252"><li class="list__item" id="-nwwk6s_253"><p>none - default behavior</p></li><li class="list__item" id="-nwwk6s_254"><p>punctation - means that previous item in flow layout should always be placed on the same line as the item, which this constraint is assigned to.</p></li><li class="list__item" id="-nwwk6s_255"><p>noflow - excludes a cell from flow layout. Current line is finished and item is placed below it. After this item a new line is started and normal flow layout is applied. This style can be used to embed a picture inside of text.</p></li></ul></li></ul></li><li class="list__item" id="-nwwk6s_256"><p><em id="-nwwk6s_257">underlined</em> - Can be either underlined, not underlined, or as is ('as is' means it depends on properties of the enclosing cell collection).</p></li></ul></section><section class="chapter"><h3 id="stylepropertiespropagation" data-toc="stylepropertiespropagation">Style properties propagation</h3><p id="-nwwk6s_258">While some style properties affect only the cell to which they are applied, values of other properties are pushed down the cell subtree (nested cells) and applied to them until some of the child cells specifies its own value for the property. Such inheritable properties that are pushed down the cell hierarchy include <em id="-nwwk6s_259">text-foreground-color</em>, <em id="-nwwk6s_260">text-background-color</em>, <em id="-nwwk6s_261">background-color</em>, <em id="-nwwk6s_262">font-style</em>, <em id="-nwwk6s_263">font-size</em>&nbsp;and many others.</p></section><section class="chapter"><h3 id="customstyles" data-toc="customstyles">Custom styles</h3><p id="-nwwk6s_264">Language designers can define their own style attributes in Style Sheets and then use them in the editor. This increases the flexibility of the language editor definition. The attributes may hold values of different types and can optionally provide default values.</p><figure id="-nwwk6s_265"><img alt="styles500.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/styles500.png" title="styles500.png" width="292" height="123"></figure><p id="-nwwk6s_266">There are two types of custom style attributes:</p><ul class="list _bullet" id="-nwwk6s_267"><li class="list__item" id="-nwwk6s_268"><p>simple - applied to a single editor cell only</p></li><li class="list__item" id="-nwwk6s_269"><p>inherited - applied to a cell and all its descendant cells recursively</p></li></ul><p id="-nwwk6s_270">In order to use the style attribute in an editor definition, your language has to import the language defining the attribute and the <em id="-nwwk6s_271">editor</em>&nbsp;aspect has to list the defining language among the used languages. To refer to the custom attribute from within <em id="-nwwk6s_272">BaseLanguage</em>&nbsp;code, you need to import <em id="-nwwk6s_273">jetbrains.mps.lang.editor</em> to get access to the <em id="-nwwk6s_274">StyleAttributeReferenceExpression</em> concept.</p><div class="code-block" data-lang="none">EditorCell cell = ...
cell.getStyle().get(styleAttribute/myValue/);
</div></section><section class="chapter"><h3 id="styleinheritance" data-toc="styleinheritance">Style inheritance</h3><p id="-nwwk6s_276">To be truly usable, style classes need an extension mechanism in order to describe that a particular style class inherits values of all style properties, which are not overridden explicitly. We can use a special style property <em id="-nwwk6s_277">apply</em> to copy values of all properties specified in the parent style class into our style class. Using the&nbsp;<em id="-nwwk6s_278">apply</em> property is semantically equivalent to copy-pasting all of the properties from the parent style class. An&nbsp;<em id="-nwwk6s_279">apply-if</em>&nbsp;variant is also available to apply a style property value conditionally. Unlike traditional style-extension, the apply mechanism allows multiple classes to be inherited from.</p><p id="-nwwk6s_280">The <em id="-nwwk6s_281">unapply</em>&nbsp;property allows style classes to cease the effect of selected inherited properties. For example, a style class for commented-out code will push down styles that make code elements look all gray. Yet, links may need to be rendered in their usual colors so that the user can spot them and potentially click them.</p><p id="-nwwk6s_282">Potential conflicts between properties specified in parent styles and the ones defined explicitly in the inheriting cell are resolved on the order basis.The&nbsp;last specified value overrides all previous values of the same style property.</p><p id="-nwwk6s_283">For example, the <em id="-nwwk6s_284">ConsoleRoot</em>&nbsp;concept provides a read-only editor with only a single point (the <em id="-nwwk6s_285">commandHolder</em>&nbsp;cell), where edits are allowed. First the <em id="-nwwk6s_286">readOnly</em>&nbsp;style class is set on the editor:</p><figure id="-nwwk6s_287"><img alt="style4.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/style4.png" title="style4.png" width="506" height="297"></figure><p id="-nwwk6s_288">and then the <em id="-nwwk6s_289">readOnly</em>&nbsp;style class is unapplied for the <em id="-nwwk6s_290">commandHolder</em>&nbsp;cell:</p><figure id="-nwwk6s_291"><img alt="style5.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/style5.png" title="style5.png" width="507" height="297"></figure><p id="-nwwk6s_292">The <em id="-nwwk6s_293">readOnly</em>&nbsp;style class is defined as follows:</p><figure id="-nwwk6s_294"><img alt="style30.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/style30.png" title="style30.png" width="339" height="105"></figure></section><section class="chapter"><h3 id="stylepriorities" data-toc="stylepriorities">Style priorities</h3><p id="-nwwk6s_295">A style class can be declared to take precedence over some other style class or multiple classes.</p><ol class="list _decimal" id="-nwwk6s_296" type="1"><li class="list__item" id="-nwwk6s_297"><p>If a style class does not dominate over anything, it is a <b id="-nwwk6s_298">low-level style class</b>.</p></li><li class="list__item" id="-nwwk6s_299"><p>If a style class declares to dominate, but does not specifies a style class that it <em id="-nwwk6s_300">dominates</em> over (no style class is specifies but words <em id="-nwwk6s_301">dominate over</em>&nbsp;present), the style class is considered dominating over all low-level style classes.</p></li><li class="list__item" id="-nwwk6s_302"><p>The <em id="-nwwk6s_303">domination relation</em> is <b id="-nwwk6s_304">transitive</b>, <b id="-nwwk6s_305">cycles</b> are not allowed.</p></li></ol><p id="-nwwk6s_306">The domination relation makes sense only for styles with inheritable attributes. When one value of some style property is pushed down from parent and another value for the same property is specified in the style class applied to the current cell, the resulting behavior depends on the relationship between the two style classes:</p><ol class="list _decimal" id="-nwwk6s_307" type="1"><li class="list__item" id="-nwwk6s_308"><p>If both style classes are <b id="-nwwk6s_309">low-level</b>, the value pushed from parent will be ignored and replaced with value from style class of current cell.</p></li><li class="list__item" id="-nwwk6s_310"><p>If one of style classes dominates over the other, both values are&nbsp;kept&nbsp;and pushed down, but values from the style class, which dominates, hides the values from the other style class.</p></li><li class="list__item" id="-nwwk6s_311"><p>If, however, in some child cell the style class that dominates is unapplied (with special style property <em id="-nwwk6s_312">unapply</em>), values from the other style class will become resulting values for this property.</p></li></ol><p id="-nwwk6s_313">For example, a comment containing the word TODO should be styled more prominently then a plain comment. Thus the language concept representing a comment needs to apply a TODO-aware style (<em id="-nwwk6s_314">TODO_Style</em>), which declares its dominance over a plain&nbsp;<em id="-nwwk6s_315">Comment_Style</em>. The actual styling properties are, however, only applied if the comment really contains the TODO text (isToDo()), otherwise the plain&nbsp;<em id="-nwwk6s_316">Comment_Style</em>&nbsp;properties are used.</p><figure id="-nwwk6s_317"><img alt="style7.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/style7.png" title="style7.png" width="893" height="83"></figure><p id="-nwwk6s_318">Use the <em id="-nwwk6s_319">"Add Dominance"</em>&nbsp;intention to append the <em id="-nwwk6s_320">dominates over</em>&nbsp;clause to a style:</p><figure id="-nwwk6s_321"><img alt="style31.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/style31.png" title="style31.png" width="244" height="103"></figure></section></section><section class="chapter"><h2 id="cellactions" data-toc="cellactions">Cell actions</h2><p id="-nwwk6s_322">Every cell model may have some actions associated with it. Such actions are meant to improve usability of editing. You can specify them in an inspector of any cell model.</p><section class="chapter"><h3 id="keymaps" data-toc="keymaps">Key maps</h3><p id="-nwwk6s_323">You may specify a reference to a key map for your cell model. A key map is a root concept - a set of key map items each consisting of a keystroke and an action to perform. A cell generated from a cell model with a reference to a certain key map will execute appropriate actions on keystrokes.</p><p id="-nwwk6s_324">In a key map you must specify a concept for which a key map is applicable. For instance, if you want to do some actions with an expression, you must specify Expression as an applicable concept; then you may specify such a key map only for those cell models which are contained inside editor declarations for descendants of Expression, otherwise it is a type error.</p><p id="-nwwk6s_325">If a key map property "everyModel" is "true," then this key map behaves as if it is specified for every cell in the editor. It is useful when you have many descendants of a certain concept which have many different editors, and your key map is applicable to their ancestor. You need not specify such a key map in every editor if you mark it as an "every model" key map.</p><p id="-nwwk6s_326">A key map item consists of the following features:</p><ul class="list _bullet" id="-nwwk6s_327"><li class="list__item" id="-nwwk6s_328"><p>A function which is executed when a key map item is triggered (returns nothing)</p></li><li class="list__item" id="-nwwk6s_329"><p>A set of keystrokes which trigger this key map item</p></li><li class="list__item" id="-nwwk6s_330"><p>A boolean function which determines if a key map item is applicable here (if not specified, then it's always applicable). If a key map item is not applicable the moment it is triggered, then it will not perform an action.</p></li><li class="list__item" id="-nwwk6s_331"><p>You may specify caret policy for a key map item. Caret policy says where in a cell a caret should be located to make this key map item enabled. Caret policy may be either first position, last position, intermediate position, or any position. By default, caret policy is "any position." If a caret in a cell does not match the caret policy of a key map item the moment it is triggered, then this key map item will not perform an action.</p></li></ul></section><section class="chapter"><h3 id="actionmaps" data-toc="actionmaps">Action maps</h3><p id="-nwwk6s_332">A cell model may contain a reference to an action map. An action map overrides some default cell actions for a certain concept. An action map consists of several action map items. In an action map, you must specify a concept for which the action map is applicable.</p><p id="-nwwk6s_333">An action map item contains:</p><ul class="list _bullet" id="-nwwk6s_334"><li class="list__item" id="-nwwk6s_335"><p>an action description which is a string,</p></li><li class="list__item" id="-nwwk6s_336"><p>and a function which performs an action (returns nothing).</p></li></ul><p id="-nwwk6s_337">An action map item may override one of the default actions (see Actions). For instance, when you have a return statement without any action maps in its editor, and you press Delete on a cell with the keyword "return," the whole statement is deleted. But you may specify an action map containing a delete action map item, which instead of just deleting return statement replaces it with an expression statement containing the same expression as the deleted return statement.</p><p> action DELETE description : &lt;no description&gt; execute : (node, editorContext)-&gt;void { node &lt; ExpressionStatement &gt; expressionStatement = node . replace with new ( ExpressionStatement ) ; expressionStatement . expression . set ( node . expression ) ; } </p><p id="-nwwk6s_338">The SELECT_ALL action, which selects the whole contents of the editor and is triggered by&nbsp;<kbd id="-nwwk6s_339" data-key="$SelectAll">Ctrl+A</kbd>, can also be customised through <b id="-nwwk6s_340">action maps</b>. The&nbsp;<code class="code" id="-nwwk6s_341">jetbrains.mps.nodeEditor.selection.SelectUpUtil</code>&nbsp;class with&nbsp;<code class="code" id="-nwwk6s_342">executeWhile</code>&nbsp;method can be leveraged to specify an upper selection boundary for this action.</p><figure id="-nwwk6s_343"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/mps-selectall.png" class="lightbox"><img alt="mps-selectall.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/mps-selectall.png" title="mps-selectall.png" width="500" height="125"></a></figure><p id="-nwwk6s_344">Action map items from an existing action map can be reused in a new action map via <b id="-nwwk6s_345">imports</b>. The users have two options:</p><ul class="list _bullet" id="-nwwk6s_346"><li class="list__item" id="-nwwk6s_347"><p>to import all items from an action map</p></li><li class="list__item" id="-nwwk6s_348"><p>to import only the item with a given action ID</p></li></ul><figure id="-nwwk6s_349"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/image2018-9-14-13-23-37.png" class="lightbox"><img alt="image2018-9-14-13-23-37.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/image2018-9-14-13-23-37.png" title="image2018-9-14-13-23-37.png" width="500" height="259"></a></figure><p id="-nwwk6s_350">Importing actions follows the following rules:</p><ul class="list _bullet" id="-nwwk6s_351"><li class="list__item" id="-nwwk6s_352"><p>Imports work transitively.</p></li><li class="list__item" id="-nwwk6s_353"><p>Actions defined in the current cell action map have priority over actions defined in any of the imported cell action maps.</p></li><li class="list__item" id="-nwwk6s_354"><p>If multiple imported maps define an action of the same type, the most recently imported one takes precedence.</p></li><li class="list__item" id="-nwwk6s_355"><p>Cyclic imports are not allowed.</p></li><li class="list__item" id="-nwwk6s_356"><p>The applicable concept of any imported cell action map has to be the same concept or a super-concept of the applicable concept of this map.</p></li><li class="list__item" id="-nwwk6s_357"><p>Action map imports work cross-language: an action map in the editor aspect of one language can import an action map from the editor aspect of another language.</p></li></ul><p id="-nwwk6s_358">The DELETE and BACKSPACE action handlers have specific semantics. If an action map <b id="-nwwk6s_359">defines or imports</b> a DELETE handler and <b id="-nwwk6s_360">does not define or import</b> a BACKSPACE handler, a default BACKSPACE handler identical to the one for DELETE is registered automatically.</p><p id="-nwwk6s_361">The resolution of imported action handlers is dynamic (happens at run-time. When action map A imports items from action map B, the exact action handlers that will be registered are not resolved at generation time of action map A. Instead, code is generated that will register handlers provided by action map B at runtime. As a result, action map A does not have to be regenerated when action map B changes.</p></section></section><section class="chapter"><h2 id="cellmenus" data-toc="cellmenus">Cell menus</h2><p id="-nwwk6s_362">One may specify a custom completion menu for a certain cell. Open an inspector for your cell declaration, find a table named Common, find a row named menu, create a new cell menu descriptor. Cell menu descriptor consists of menu parts, which are of differend kinds, which are discussed below.</p><section class="chapter"><h3 id="propertyvaluesmenupart" data-toc="propertyvaluesmenupart">Property values menu part</h3><p id="-nwwk6s_363">This menu part is available on property cells, it specifies a list of property values for your property which will be shown in completion. One should write a function which returns a value of type list&lt;String&gt;.</p></section><section class="chapter"><h3 id="propertypostfixhintsmenupart" data-toc="propertypostfixhintsmenupart">Property postfix hints menu part</h3><p id="-nwwk6s_364">This menu part is available on property cells, it specifies a list of strings which serve as "good" postfixes for your property value. In such a menu part one should write a function which returns a value of type list&lt;String&gt;. Such a menu is useful if you want MPS to "guess" a good value for a property. For instance, one may decide that it will be a good variable name which is a variable type name but with the first letter being lowercased, or which ends with its type name: for a variable of type "Foo" good names will be "foo", "aFoo", "firstFoo", "goodFoo", etc. So one should write in a variable declaration's editor in a menu for property cell for variable name such a menu part:</p><p> property postfix hints postfixes : (scope, operationContext, node)-&gt;list&lt;String&gt; { list &lt; String &gt; result ; node &lt; Type &gt; nodeType = node . type ; if ( nodeType != null ) { result = MyUtil.splitByCamels( nodeType . getPresentation() ); } else { result = new list &lt; String &gt; { empty } ; } return result ; } </p><p id="-nwwk6s_365">where splitByCamels() will be a function which returns a list of postfixes of a string starting with capitals (for instance MyFooBar -&gt; MyFooBar, FooBar, Bar).</p></section><section class="chapter"><h3 id="primaryreplacechildmenu" data-toc="primaryreplacechildmenu">Primary replace child menu</h3><p id="-nwwk6s_366">It's a cell menu part which returns primary actions for child (those by default, as if no cell menu exists).</p></section><section class="chapter"><h3 id="primarychoosereferentmenu" data-toc="primarychoosereferentmenu">Primary choose referent menu</h3><p id="-nwwk6s_367">It's a cell menu part which returns primary actions for referent (those by default, as if no cell menu exists).</p></section><section class="chapter"><h3 id="replacenodemenu(customnode'sconcept)" data-toc="replacenodemenu(customnode'sconcept)">Replace node menu (custom node's concept)</h3><p id="-nwwk6s_368">This kind of cell menu parts allows to replace an edited node (i.e. node on which a completion menu is called) with instances of a certain specified concept and its subconcepts. Such a cell menu part is useful, for example, when you want a particular cell of your node's editor to be responsible for replacement of a whole node. For instance, consider an editor for binary operations. There's a common editor for all binary operations which consists of a cell for left operand, a cell for operation sign which is a cell for concept property "alias" and a cell for right operand.</p><p> [&gt; % leftExpression % ^{{ alias }} % rightExpression % &lt;] </p><p id="-nwwk6s_369">It is natural to create a cell menu for a cell with operation sign, which will allow to replace an operation sign with another one, (by replacing a whole node of course). For such a purpose one will write in the cell for operation sign a replace node menu part:</p><p> replace node (custom node concept) replace with : BinaryOperation </p><p id="-nwwk6s_370">The former left child and right child are added to newly created BinaryOperation according to <a href="editor-actions.html#node_factories" id="-nwwk6s_371">Node Factories</a> for BinaryOperation concept.</p></section><section class="chapter"><h3 id="replacechildmenu(customchild'sconcept)" data-toc="replacechildmenu(customchild'sconcept)">Replace child menu (custom child's concept)</h3><p id="-nwwk6s_372">Such a cell menu part is applicable to a cell for a certain child and specifies a specific concept which and subconcepts of which will be shown in completion menu (and instantiated when chosen and the instance will be set as a child). To specify that concept one should write a function which returns a value of a type node&lt;ConceptDeclaration&gt;.</p></section><section class="chapter"><h3 id="replacechildmenu(customaction)." data-toc="replacechildmenu(customaction).">Replace child menu (custom action).</h3><p id="-nwwk6s_373">This kind of cell menu parts is applicable to a cell for a certain child and allows one to customize not only child concept, but the whole replace child action: matching text (text which will be shown in completion menu), description text (a description of an action, shown in the right part of completion menu), and the function which creates a child node when the action is selected from completion menu. Hence, to write such a menu one should specify matching text, description text and write a function returning a node (this node should be an instance of a target concept specified in a respective child link).</p></section><section class="chapter"><h3 id="genericmenuitem" data-toc="genericmenuitem">Generic menu item</h3><p id="-nwwk6s_374">This kind of cell menu part allows one to make MPS perform an arbitrary action when a respective menu item will be selected in a completion menu. One should specify matching text for a menu item and write a function which does what one wants. For instance, one may not want to show a child list cell for class fields if no class fields exist. Hence one can't use its default actions to create a new field. Instead, one can create somewhere in a class' editor a generic menu item with matching text "create field" which creates a new field for a class.</p><p> generic item matching text : add field handler : (node, model, scope, operationContext)-&gt;void { node . field . add new ( &lt;default&gt; ) ; }</p></section><section class="chapter"><h3 id="actiongroups" data-toc="actiongroups">Action groups</h3><p id="-nwwk6s_375">An action group is a cell menu part which returns a group of custom actions. At runtime, during the menu construction, several objects of a certain type, which are called parameter objects, are collected or created. For that parameter object type of an action group functions, which return their matching text and description text, are specified. A function which is triggered when a menu item with a parameter object is chosen is specified also.</p><p id="-nwwk6s_376">Thus, an action group description consists of:</p><ul class="list _bullet" id="-nwwk6s_377"><li class="list__item" id="-nwwk6s_378"><p>a parameter object type;</p></li><li class="list__item" id="-nwwk6s_379"><p>a function which returns a list of parameter objects of a specified type (takes an edited node, scope and operation context);</p></li><li class="list__item" id="-nwwk6s_380"><p>a function which takes a parameter object of a specified type and returns matching text (a text which will be shown in a completion menu);</p></li><li class="list__item" id="-nwwk6s_381"><p>a function which takes a parameter object of a specified type and returns description text for a parameter object;</p></li><li class="list__item" id="-nwwk6s_382"><p>a function which performs an action when parameter object is chosen in a completion menu.</p></li></ul><p id="-nwwk6s_383">A function which performs an action may be of different kinds, so there are three different kinds of cell action group menu parts:</p><ul class="list _bullet" id="-nwwk6s_384"><li class="list__item" id="-nwwk6s_385"><p>Generic action group. Its action function, given a parameter object, performs an arbitrary action. Besides the parameter object, the function is provided with edited node, its model, scope and operation context.</p></li><li class="list__item" id="-nwwk6s_386"><p>Replace child group. It is applicable to child cells and its action function, given a parameter object, returns a new child, which must have a type specified in a respective child link declaration. Besides the parameter object, the function is provided with edited node, its model, current child(i.e. a child being replaced), scope and operation context.</p></li><li class="list__item" id="-nwwk6s_387"><p>Replace node group. Its action function, given a parameter object, returns a node. Usually it is some referent of an edited node (i.e. node on which a completion menu is called). Besides the parameter object, the function is provided with edited node, its model, scope and operation context.</p></li></ul></section><section class="chapter"><h3 id="cellmenucomponents" data-toc="cellmenucomponents">Cell menu components</h3><p id="-nwwk6s_388">When some menu parts in different cells are equal one may want to extract them into a separate and unique entity, to avoid duplications. For such a purpose cell menu components are meant. A cell menu component consists of a cell menu descriptor (a container for cell menu parts) and a specification of an applicable feature. A specification of applicable feature contains a reference to a feature (i.e. child link declaration, reference link declaration or property declaration), to which a menu is applicable. For instance if your menu component will be used to replace some child its child link declaration should be specified here; etc.</p><p id="-nwwk6s_389">When a cell menu component is created, it can be used in cell menus via cell menu component menu part, which is a cell menu part which contains a reference to a certain menu component. <a href="smodel-language.html" id="-nwwk6s_390">SModel language</a></p></section></section><section class="chapter"><h2 id="customizingreferencepresentation" data-toc="customizingreferencepresentation">Customizing reference presentation</h2><p id="-nwwk6s_391">Specification of the matching text and in-editor textual presentation for references can be done directly in the editor aspect.</p><p id="-nwwk6s_392">The&nbsp;<em id="-nwwk6s_393">ref. presentation</em> cell can have the displayed text customized:</p><figure id="-nwwk6s_394"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/RefCust1.png" class="lightbox"><img alt="RefCust1.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/RefCust1.png" title="RefCust1.png" width="500" height="282"></a></figure><p id="-nwwk6s_395">The&nbsp;<em id="-nwwk6s_396">cell menu</em> can customise the text displayed in the completion menu:</p><figure id="-nwwk6s_397"><a href="https://resources.jetbrains.com/help/img/idea/2024.1/RefCust2.png" class="lightbox"><img alt="RefCust2.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/RefCust2.png" title="RefCust2.png" width="500" height="319"></a></figure><p id="-nwwk6s_398">This functionality was previously achieved through&nbsp;<em id="-nwwk6s_399">Constraints</em>.</p></section><section class="chapter"><h2 id="migrationofpresentationqueryinreferenceconstraints" data-toc="migrationofpresentationqueryinreferenceconstraints">Migration of presentation query in reference constraints</h2><p id="-nwwk6s_400">The design of the reference presentation part in the constraints&nbsp;aspect has been showing its age and so has been replaced with the new functionality described above.Most of the code will be migrated automatically. Some code that produced with migration can be simplified so consider to review it.</p><p id="-nwwk6s_401">There is a case when a presentation query cannot be migrated: suppose you have an editor for a concept with reference link and then have a reference constraint with defined presentation part for its&nbsp;reference&nbsp;in one of its subconcepts. If editor component doesn't overridden in subconcept, MPS doesn't know where this presentation part should be inlined. In this case, you should manually migrate the presentation part usage to prevent uncorrected reference presentation in user code. There are several alternatives to do it:</p><ul class="list _bullet" id="-nwwk6s_402"><li class="list__item" id="-nwwk6s_403"><p>Simply override the editor in subconcept. Move the code from presentation part to the proper reference cell.</p></li><li class="list__item" id="-nwwk6s_404"><p>Extract the reference cell into a separate component and override the component for subconcept.</p></li><li class="list__item" id="-nwwk6s_405"><p>Create new behavior method that provides a presentation for the reference. Make reference cell delegates to created method. Override this method in subconcept.</p></li></ul><p id="-nwwk6s_406">If you are expecting that your language may be extended in another project by someone else, do&nbsp;<b id="-nwwk6s_407">not</b>&nbsp;remove deprecated presentation parts. Otherwise, extending languages may be migrated improperly.</p></section><section class="chapter"><h2 id="two-stepdeletion" data-toc="two-stepdeletion">Two-step deletion</h2><p id="-nwwk6s_408">In projectional editor it is sometimes hard to predict what part of the code will be deleted when you press <em id="-nwwk6s_409">Delete</em> or <em id="-nwwk6s_410">Backspace</em>. For example, when the caret is on the semicolon of the baseLanguage statement and you press <em id="-nwwk6s_411">Backspace</em>, the whole statement will be deleted.&nbsp;With <b id="-nwwk6s_412">two step deletion</b>, you now can see what part of the code which will be deleted. Here how it works: you press <em id="-nwwk6s_413">Delete</em> or <em id="-nwwk6s_414">Backspace</em> and the part of the code, which is to be deleted, becomes highlighted. If it suits you, you press <em id="-nwwk6s_415">Delete</em> or <em id="-nwwk6s_416">Backspace</em> again and the code will be deleted. If after highlighting you realize that you don't want to delete this piece of code you can press <em id="-nwwk6s_417">Escape</em> or just move the caret and the highlighting will disappear.</p><p id="-nwwk6s_418">Let's see the example: Place the caret to the statement semicolon.</p><figure id="-nwwk6s_419"><img alt="Semicolon.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Semicolon.png" title="Semicolon.png" width="706" height="124"></figure><p id="-nwwk6s_420">Press <em id="-nwwk6s_421">Backspace</em>. The whole statement is highlighted. This means that if you press <em id="-nwwk6s_422">Backspace</em> again, the statement will be deleted.</p><figure id="-nwwk6s_423"><img alt="Semicolon-highlighted.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Semicolon-highlighted.png" title="Semicolon-highlighted.png" width="720" height="120"></figure><p id="-nwwk6s_424">Press <em id="-nwwk6s_425">Backspace</em> again. The statement is deleted.</p><figure id="-nwwk6s_426"><img alt="Deleted.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/Deleted.png" title="Deleted.png" width="702" height="116"></figure><p id="-nwwk6s_427">The same works by default for other nodes.</p><aside class="prompt" data-type="warning" data-title="" id="-nwwk6s_428"><p id="-nwwk6s_429">Note that if the node is selected, it will be removed immediately without highlighting. Also if the caret is on the editable text cell, the text parts will be also removed immediately.</p></aside><p id="-nwwk6s_430">To turn on the two step deletion, check the "two step deletion" checkbox in&nbsp;<b id="-nwwk6s_431">Preferences &gt; Editor &gt; General</b>.</p><section class="chapter"><h3 id="invokingtwo-stepdeletionfromcode" data-toc="invokingtwo-stepdeletionfromcode">Invoking two-step deletion from code</h3><p id="-nwwk6s_432">The language designer may include the two step deletion scenario in her custom delete actions. The&nbsp;<b id="-nwwk6s_433">ApproveDelete_Operation</b>in&nbsp;<em id="-nwwk6s_434">jetbrains.mps.lang.editor</em>is introduced for that purpose. This operation is applied to the node:</p><figure id="-nwwk6s_435"><img alt="appr-del.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/appr-del.png" title="appr-del.png" width="616" height="34"></figure><p id="-nwwk6s_436">This operation returns true iff it succeed and the node has not been approved for deletion before. More formally all the following conditions need to be met:</p><p id="-nwwk6s_437">1) The two-step deletion preferences option is checked.</p><p id="-nwwk6s_438">2) The node has not been fully selected.</p><p id="-nwwk6s_439">3) The node has not been approved for deletion already.</p><p id="-nwwk6s_440">When all of these conditions are met, the node approved for deletion gets highlighted and the custom delete action may stop at this point.</p><p id="-nwwk6s_441">If the same custom delete action is called immediately after approving the deletion, the <em id="-nwwk6s_442">approveDelete</em> operation will return false (because the node has been approved already) and the action will proceed with the deletion.</p><p id="-nwwk6s_443">Let's see the typical scenario from the baseLanguage:</p><figure id="-nwwk6s_444"><img alt="dotE.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/dotE.png" title="dotE.png" width="1100" height="74"></figure><p id="-nwwk6s_445">This is the part of the delete action for the&nbsp;<b id="-nwwk6s_446">Dot_Expression's</b>&nbsp;operation. This action first tries to approve the operation for the deletion and if it succeeds the action stops. If ir does not succeed, that means that either node's operation has already been approved (= highlighted), or the node has been selected by the user or the "two step deletion" preferences option is turned off. In this case, we delete the operation and replace it with the node of the abstract concept.</p></section><section class="chapter"><h3 id="morecomplexcases" data-toc="morecomplexcases">More complex cases</h3><p id="-nwwk6s_447">Sometimes the customized delete action needs to be more complicated than just deleting the current node.</p><p id="-nwwk6s_448">Let's see an example scenario: we press delete on the "final" keyword on the&nbsp;<b id="-nwwk6s_449">IncompleteMemberDeclaration</b>. There is a custom action, which sets the&nbsp;<em id="-nwwk6s_450">final</em>property to false. <b id="-nwwk6s_451"></b> In the editor, there is the cell, which is shown only if the&nbsp;<em id="-nwwk6s_452">final</em> property of the node is true. So after the action, the cell is not shown.</p><p id="-nwwk6s_453">If we want to highlight the final keyword before hiding it (by setting the <em id="-nwwk6s_454">final</em> property to false), we approve it for the deletion this way:</p><figure id="-nwwk6s_455"><img alt="final.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/final.png" title="final.png" width="1256" height="76"></figure><aside class="prompt" data-type="tip" data-title="" id="-nwwk6s_456"><p>For more information about how to test the "approved for deletion" flag, especially in editor tests, refer to <a href="testing-languages.html#testingtwophasedeletion" id="-nwwk6s_457">two-step deletion in tests</a>.</p></aside></section></section><section class="chapter"><h2 id="selecting_editor_cells" data-toc="selecting_editor_cells">Selecting editor cells</h2><p id="-nwwk6s_458">To select a particular cell programatically you can use the <em id="-nwwk6s_459">select</em> construct from the <em id="-nwwk6s_460">jetbrains.mps.lang.editor</em> language:</p><div class="code-block" data-lang="none">node.select[in: editorContext, cell: MOST_RELEVANT, selectionStart: 0, selectionEnd: -1]</div><div class="code-block" data-lang="none">node.select[in: editorContext, cell: FIRST]</div><p id="-nwwk6s_463">A couple of notes:</p><ul class="list _bullet" id="-nwwk6s_464"><li class="list__item" id="-nwwk6s_465"><p>Not all the parameters must be specified.</p></li><li class="list__item" id="-nwwk6s_466"><p>The editorContext value must always be specified.</p></li><li class="list__item" id="-nwwk6s_467"><p>The "cell" value can be specified by its ID (if specified in the editor definition), as a property reference or a property specified with an expression.</p></li><li class="list__item" id="-nwwk6s_468"><p>The "cell" can also be specified by one of the available pre-defined values, such as "FIRST", "LAST_EDITABLE", etc.</p></li><li class="list__item" id="-nwwk6s_469"><p>Value -1 for a selection index means the "last" position.</p></li></ul></section><section class="chapter"><h2 id="-nwwk6s_4" data-toc="-nwwk6s_4">Custom style and priority of completion items (EXPERIMENTAL)</h2><figure id="-nwwk6s_470"><img alt="CompletionStylingConceptFunc.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/CompletionStylingConceptFunc.png" title="CompletionStylingConceptFunc.png" width="2590" height="226"></figure><p id="-nwwk6s_471">The language designers can set the style and the priority for the items in a completion menu. In order to do so the language designer should create the <em id="-nwwk6s_472">Completion Styling</em> root in the editor aspect of the language. In order to specify the style of a completion menu item the language designer should first specify the item.</p><p id="-nwwk6s_473">We currently provide two possible selectors of the completion items:</p><ul class="list _bullet" id="-nwwk6s_474"><li class="list__item" id="-nwwk6s_475"><p>Items which modify instances of a specific concept.This selector selects items which appear in the completion menu when the user puts the caret at the node of the concept (or it's properties, references, or children) and presses <em id="-nwwk6s_476">Control + Space</em></p></li><li class="list__item" id="-nwwk6s_477"><p>Items which create instances of a specific concept. Those are mainly the substitute actions. For example, when user selects the <em id="-nwwk6s_478">ReturnStatement</em> which is in the <em id="-nwwk6s_479">StatementList</em>and presses <em id="-nwwk6s_480">Control + Space</em>, the items in the completion menu are creating the instances of <em id="-nwwk6s_481">Statement</em> and replace the <em id="-nwwk6s_482">ReturnStatement</em> with those instances. So the selector for actions creating instances of <em id="-nwwk6s_483">Statement</em> will select those items.</p></li></ul><p id="-nwwk6s_484">It is important that one item could be selected by several selectors. For example, in the situation above several selectors will match one completion item:</p><ul class="list _bullet" id="-nwwk6s_485"><li class="list__item" id="-nwwk6s_486"><p>for actions creating the instances of <em id="-nwwk6s_487">Statement</em> (because the item will replace the current node with another <em id="-nwwk6s_488">Statement</em>)</p></li><li class="list__item" id="-nwwk6s_489"><p>for actions modifying instances of <em id="-nwwk6s_490">Statement</em> (because the current node is <em id="-nwwk6s_491">ReturnStatement</em> which is also <em id="-nwwk6s_492">Statement</em>)</p></li><li class="list__item" id="-nwwk6s_493"><p>for actions modifying instances of <em id="-nwwk6s_494">StatementList:statement</em> (because the menu item will paste a new node into the statement role of parent <em id="-nwwk6s_495">StatementList</em>)</p></li></ul><p id="-nwwk6s_496">So you should prefer the most specific selector possible. For example, a selector or an actions modifying instances of <em id="-nwwk6s_497">BaseConcept</em> is the least specific selector and will affect all completion menu items</p><figure id="-nwwk6s_498"><img alt="CompletionStylingStrike.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/CompletionStylingStrike.png" title="CompletionStylingStrike.png" width="1882" height="206"></figure><p id="-nwwk6s_499">Once the selector matches a menu item, the language designer could customize it's style. The <em id="-nwwk6s_500">style object</em> serves this purpose.</p><p id="-nwwk6s_501">Currently it is possible to:</p><ul class="list _bullet" id="-nwwk6s_502"><li class="list__item" id="-nwwk6s_503"><p>make the item's font bold</p></li><li class="list__item" id="-nwwk6s_504"><p>make the item's font italic</p></li><li class="list__item" id="-nwwk6s_505"><p>strike out the item's text (useful for deprecating the concepts)</p></li><li class="list__item" id="-nwwk6s_506"><p>set the item's background and text color</p></li><li class="list__item" id="-nwwk6s_507"><p>hide an item</p></li><li class="list__item" id="-nwwk6s_508"><p>set the item's priority</p></li></ul><p id="-nwwk6s_509">Note that all the styles accumulate:</p><ul class="list _bullet" id="-nwwk6s_510"><li class="list__item" id="-nwwk6s_511"><p>If at least one styler sets any of the bold/italic/hide styles, the item will be bold/italic/hidden.</p></li><li class="list__item" id="-nwwk6s_512"><p>If the background or the text colors conflict, the first one specified will be used.</p></li><li class="list__item" id="-nwwk6s_513"><p>The priorities are used to sort the items. The biggest value set as a priority for an item by the stylers is used.</p></li><li class="list__item" id="-nwwk6s_514"><p>Items are first sorted by priorities and then by the level of matching the user's text. Currently there is no way to override this level.</p></li></ul><p id="-nwwk6s_515">There are several parameters the language designer can use. They are stored in the item.</p><section class="chapter"><h3 id="-nwwk6s_5" data-toc="-nwwk6s_5">Information parameters:</h3><ul class="list _bullet" id="-nwwk6s_516"><li class="list__item" id="-nwwk6s_517"><p><b id="-nwwk6s_518">matchingText</b> - the text appearing on the left side of the item. This text is used to filter the items when the user types the text in the completion menu.</p></li><li class="list__item" id="-nwwk6s_519"><p><b id="-nwwk6s_520">descriptionText</b> - the text appearing on the right side of the item.</p></li><li class="list__item" id="-nwwk6s_521"><p><b id="-nwwk6s_522">parameterObject</b> - some of the items can be parameterized with an object. For example, items which change the node's reference are parameterized with the target of the reference which they will set when executed.</p></li><li class="list__item" id="-nwwk6s_523"><p><b id="-nwwk6s_524">outputConcept</b> - some actions, like substitute actions create new nodes, the output concept is the concept of the new node.</p></li></ul></section><section class="chapter"><h3 id="-nwwk6s_6" data-toc="-nwwk6s_6">A few notable examples of stylers in baseLanguage:</h3><ul class="list _bullet" id="-nwwk6s_525"><li class="list__item" id="-nwwk6s_526"><p><em id="-nwwk6s_527">ReturnStatementStyling</em> which makes a return item bold and sets its priority to non-zero, if it is last in the current statement list. </p><figure id="-nwwk6s_528"><img alt="CompletionStylingReturn.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/CompletionStylingReturn.png" title="CompletionStylingReturn.png" width="2286" height="330"></figure></li><li class="list__item" id="-nwwk6s_529"><p><em id="-nwwk6s_530">VariableReferencePriority</em> which sets the items priority to non-zero if the item references a variable declaration. </p><figure id="-nwwk6s_531"><img alt="CompletionStylingVarRef.png" src="https://resources.jetbrains.com/help/img/idea/2024.1/CompletionStylingVarRef.png" title="CompletionStylingVarRef.png" width="2578" height="350"></figure></li></ul></section><section class="chapter"><h3 id="-nwwk6s_7" data-toc="-nwwk6s_7">IMPORTANT NOTE:</h3><p id="-nwwk6s_532">This feature is experimental and its design could be changed a lot in the future. The feedback regarding this feature will be very appreciated and will help us improve it. There is a possibility to turn this functionality off: Settings-&gt;Editor-&gt;General-&gt;Use completion styling</p></section></section><div class="last-modified">Last modified: 17 April 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="structure.html" class="navigation-links__prev">Structure</a><a href="editor-actions.html" class="navigation-links__next">Editor Actions</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/storage/help-app/v6/app.js"></script></body></html>